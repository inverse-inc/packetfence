// to display images directly on GitHub
ifdef::env-github[]
:imagesdir: ../images
endif::[]

This section has been created to give a quick start to configure the PacketFence PKI in PacketFence. This guide does not include advanced troubleshooting of EAP-TLS connections. Refer to the relevant documentation of EAP-TLS, RADIUS and OpenSSL for advanced features. The PacketFence PKI comes installed by default since PacketFence version 10. All certificates would be saved in the database. If you want to migrate your certificate from the old PacketFence PKI please see the upgrade section.

Certificate Authority creation
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

You will need to create a new certificate authority. Go to the PacketFence web administration under the section Configuration -> Integration -> PKI -> Certificate Authorities and click on *New Certificate Authority*

image::packetfence-pki-ca_menu.png[scaledwidth="100%",alt="Certification authority creation"]

Here's an CA example:
+++++++++++++++++++++

image::packetfence-pki-ca_creation.png[scaledwidth="100%",alt="Certification authority creation"]

Once you have created the CA, you should see the Root CA certificate displayed at the bottom of the page:
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

image::packetfence-pki-ca_created.png[scaledwidth="100%",alt="Certification authority config"]

NOTE: Don't forget to add that Root CA certifiate to the radius configuration to authorize the EAP TLS authentications using the PacketFence PKI issued certificates.

Template creation
^^^^^^^^^^^^^^^^^

Now you will need to create a certificate template that will gather all the settings for your certificate like the validity period or the certificate usage.

Select the Certificate Authority previously created:
++++++++++++++++++++++++++++++++++++++++++++++++++++

image::packetfence-pki-template_menu.png[scaledwidth="100%",alt="Template configuration"]

Here's a template example:
++++++++++++++++++++++++++

image::packetfence-pki-template_creation.png[scaledwidth="100%",alt="Template configuration"]

Clear text password when it emails the certificate to users:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

image::packetfence-pki-template_password_email.png[scaledwidth="100%",alt="Template configuration"]

Certification creation
^^^^^^^^^^^^^^^^^^^^^^

image::packetfence-pki-certificate_menu.png[scaledwidth="100%",alt="Certificate creation"]

image::packetfence-pki-certificate_creation.png[scaledwidth="100%",alt="Certificate creation"]

Once it's created, you can send it to the email user or download the p12 format:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

image::packetfence-pki-certificate_download.png[scaledwidth="100%",alt="Certificate creation"]

Revoke a certificate
^^^^^^^^^^^^^^^^^^^^

If you revoke a certificate it can't be recovered and you would need to recreate a new one. You will need to specify a reason of the revokation.

Click on the *Revoke* button on the certificate:
++++++++++++++++++++++++++++++++++++++++++++++++

image::packetfence-pki-revoked_certificate.png[scaledwidth="100%",alt="Revoke a certificate"]

PKI Provider
^^^^^^^^^^^^

You can hand out certificate to non-BYOD device on a captive portal.

First, you would need to create the PKI provider that will query the PacketFence PKI for new certifcate. Go to Configuration -> Advanced Access Configuration -> PKI provider

image::packetfence-pki-pki-provider_menu.png[scaledwidth="100%",alt="PKI Provider"]

Create a certificate per user or per device mac address, this example will cover one certificate per device:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

image::packetfence-pki-pki-provider_creation.png[scaledwidth="100%",alt="PKI Provider"]
