{"version":3,"sources":["../admin/configuration.js","../admin/config/connection_profile.js","../admin/config/domains.js","../admin/config/items.js","../admin/config/pfdetect.js","../admin/config/portal_modules.js","../admin/config/authentication.js","../admin/config/filters.js","../admin/config/fingerbank-devices.js","../admin/config/fingerbank-settings.js","../admin/config/floatingdevices.js","../admin/config/interfaces.js","../admin/config/provisioners.js","../admin/config/roles.js","../admin/config/scan-wmi.js","../admin/config/source.js","../admin/config/switches.js","../admin/config/syslogforwarded.js","../admin/config/violations.js"],"names":["init","$","on","event","form","this","url","attr","valid","isFormValid","btn","find","button","ajax","type","data","serialize","always","animate","scrollTop","resetAlert","done","showSuccess","status_msg","fail","jqXHR","getStatusMsg","showPermanentError","focus","each","i","input","value","siblings","first","tab","click","e","target","name","load","bootstrapSwitch","href","replace","window","hashchange","pfOnHashChange","updateSection","activateNavLink","initVariableList","editor","that","content","insert","initShowLinesCheckBox","file_editor_show_lines","renderer","off","setShowGutter","checked","is","initSaveModal","file_content","save_modal","save_button","val","getValue","submitFormHideModal","initCancelModal","location","initEditor","cancel_link","file_editor_buttons","enableButtonsOnChangeOnce","toggleClass","removeEventListener","setTheme","getSession","setMode","submitFormHideModalGoToLocation","setValue","removeAttr","initRenameForm","element","file_name_span","input_span","next","link","width_span","children","rename_form","html","width","removeClass","addClass","keyup","keyCode","focusout","reset","initEditorPage","ace","edit","initCollapse","closest","swap_class","stopPropagation","initCopyModal","modal","$element","removeData","async","textStatus","hash","getResponseHeader","showError","initNewFileModal","disabledLinks","initIndexPage","initCreatePage","saveBtn","confirmationBtn","initReadPage","updateDynamicRowsAfterRemove","row","selected_options","select","options","index","selector","filter","length","rows","addBack","tr","updateFilterMatchInput","currentTarget","match","exec","delegateTarget","id","emptyId","trigger","type_input","keep_value","match_input","type_value","match_input_template_id","match_input_template","changeInputFromTemplate","typeahead","source","searchSwitchesGenerator","minLength","items","matcher","item","initTemplatesPage","connectionProfileGlobalInit","initWidgets","Domains","DomainView","ItemView","call","parent","delete_item","proxy","deleteItem","save_and_join","updateAndJoinDomain","Items","disableToggle","formName","read","readItem","createSelector","update","updateItem","list_items","listItems","search","resetSearch","search_next","searchNext","submitFormGoToLocation","initActionMatchInput","updateActionMatchInput","keep","hasClass","text","confirm_link","show","preventDefault","fadeOut","empty","fadeIn","chosen","section","loader","prev","fadeTo","hide","stop","append","one","shown","rule_class","actions_table","action_row","modal_body","table","remove","row_model","updateAction","updateCondition","attribute","initializers","initializer","domainView","prototype","modalId","F","constructor","showWait","title","css","id_input","id_value","post","success","join_output","showResultModal","list","errorSibling","self","original_event","cells","get","listRefresh","list_url","replaceWith","setPassword","domain","callback","submit","evt","document","ready","domain_name","view","jbtn","initial_content","leave_output","setInterval","offsetParent","filtersView","FiltersView","revert","setupEditor","disableButtons","initialValue","enableButtonsProxy","enableButtons","jthis","FingerbankDevices","FingerbankDeviceView","showChildren","children_div","collapse","toggle","updateSectionFromForm","FloatingDevices","FloatingDeviceView","toggleTaggedVlan","checkbox","taggedVlan","interfaces","Interfaces","InterfaceView","readInterface","nodeName","parentNode","allow_single_deselect","fixChosenClipping","searchRefresh","search_url","Pfdetects","PfdetectView","showTestRegex","toggleResults","testRegex","handleChangeApiMethod","alert_element","redirect","div","icon","action","search_input","api_parameters_input","search_type","api_parameters_id","api_parameters_template","slideDown","setTimeout","dataEl","getElementById","JSON","parse","textContent","innerHTML","tree","bind","node","Provisioners","ProvisionerView","toggleInputs","togglePkiProvider","toggleWifiKey","toggleEapType","toggleServerCertificate","security_type","eap_type","passcode_input","dpsk_input","dpsk","prop","psk_size","eap_input","pki_input","server_certificate","ScanWMIRules","ScanWMIRuleView","Sources","SourceView","formSelector","testSource","changeCondition","changeAction","loadSource","addRule","addAction","addCondition","sortItems","condition","updateSoureRuleCondition","alertSibling","switches","Switches","SwitchView","readSwitch","import_csv","importSwitch","updateSwitch","delete_s","deleteConfirm","remove_group","removeGroup","add_to_group","addToGroup","changeDynamicUplinks","changeRoleMapping","addInlineTrigger","updateInlineTrigger","searchSwitch","pagination","submitSearch","searchPagination","invalidateCache","inputs","merge","uplinks","tbody","row_new","clone","insertBefore","value_new","refreshTable","iform","body","contents","showPermanentSuccess","newMemberId","a","size","refreshPage","formId","columns","status_container","refreshListFromForm","query","process","json","all_or_any","searches.0.name","searches.0.op","searches.0.value","results","map","control","c","logs_input","control_group","console","log","showViolation","inherit_select_classes","violationsView","event_triggers","elem","infos","split","toLowerCase","new_value","prettify_accounting","recompute_triggers","actions","vclose_group","inArray","role_group","command_group","t","fn","Constructor","$menu","updater","change","render","highlighter","slideUp","ViolationsView","add_combined_trigger_form","previous_trigger_options","appendTo","triggers","tid","type_select","type_name","value_pretty","append_trigger","trigger_direction","trigger_amount","trigger_unit","trigger_window","not","grouped","option","uniqueId","push","key","join","pretty","lc_value","rx","direction","amount","unit","timeframe","error","indexOf","last","add_fingerbank_trigger","display","model_stripped"],"mappings":"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","file":"configuration.js","sourcesContent":["/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\nfunction init() {\n\n    /* Save a section */\n    $('#section').on('submit', 'form[name=\"section\"]', function(event) {\n        var form = $(this);\n        var url = form.attr('action');\n        var valid = isFormValid(form);\n        var btn = form.find('.btn-primary');\n\n        if (valid) {\n            btn.button('loading');\n            $.ajax({\n                type: 'POST',\n                url: url,\n                data: form.serialize()\n            })\n            .always(function() {\n                btn.button('reset');\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                resetAlert($('#section'));\n            })\n            .done(function(data) {\n                showSuccess(form, data.status_msg);\n            })\n            .fail(function(jqXHR) {\n                var status_msg = getStatusMsg(jqXHR);\n                showPermanentError(form, status_msg);\n            });\n        }\n\n        return false;\n    });\n\n    $('#section').on('section.loaded', function(event) {\n        /* Set the focus on the first editable and visible field */\n        $(':input:not(:disabled):not([readonly]):visible:enabled:first[name]').focus();\n        /* Set the default value for compound controls */\n        $('.compound-input-btn-group .btn-group input').each(function (i, input) {\n            var value = $(input).attr('value');\n            var a = $(input).siblings('a[value=\"' + value  +  '\"]');\n            a.attr('default-value','yes');\n        });\n        /* Load the first tab on section click */\n        $('#tabView').find('[data-toggle=\"tab\"]').first().tab('show');\n\n    });\n\n    $('#section').on('reset', function(event) {\n        $('.compound-input-btn-group .btn-group a[default-value=\"yes\"]').click();\n        return true;\n    });\n\n    /* Show the tab content */\n    $('#section').on('show', '[href=\"#newTabView\"]', function(e) {\n        var btn = $(e.target);\n        var name = btn.attr(\"href\");\n        var target = $(name);\n        var url = btn.attr(\"data-href\");\n        target.load(url, function() {\n            target.find('.switch').bootstrapSwitch();\n        });\n        return true;\n    });\n    \n    /* Automatically load first category */\n    var href =  $('.sidenav-category a').first().attr('href');\n    if (href) {\n        href = href.replace(/^.*#/,\"/\");\n    } else {\n        href = \"/configuration\";\n    }\n    $(window).hashchange(pfOnHashChange(updateSection,href));\n\n    $(window).hashchange();\n\n    activateNavLink();\n}\n\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\nfunction initVariableList(editor) {\n    $('#variable_list').on('click', '.insert-into-file', function(event) {\n        var that = $(this);\n        var content = that.attr(\"data-content\");\n        editor.insert(content);\n        editor.focus();\n        return false;\n    });\n}\n\nfunction initShowLinesCheckBox(editor) {\n    var file_editor_show_lines =  $(\"#file-editor-show-lines\");\n    var renderer = editor.renderer;\n    file_editor_show_lines.off('click');\n    file_editor_show_lines.click(function (e) {\n        renderer.setShowGutter(this.checked);\n        return true;\n    });\n\n    renderer.setShowGutter(file_editor_show_lines.is(':checked'));\n}\n\nfunction initSaveModal(editor,file_content) {\n    var save_modal = $(\"#saveFile\");\n    var save_button = save_modal.find('a.btn-primary').first();\n    save_button.off('click');\n\n    save_button.click(function(event) {\n        var form     = $('#file_editor_form');\n        file_content.val(editor.getValue());\n        submitFormHideModal(save_modal,form);\n    });\n}\n\nfunction initCancelModal() {\n    $('#cancelEdit').find('a.btn-primary').first().click(function(event) {\n        window.location = $(this).attr('href');\n    });\n\n}\n\nfunction initEditor(editor,file_content) {\n    var cancel_link = $(\"#cancel-link\");\n    var file_editor_buttons = $('.form-actions a.btn.editorToggle');\n    var enableButtonsOnChangeOnce = function(e) {\n        cancel_link.attr('data-toggle','modal');\n        file_editor_buttons.toggleClass('disabled');\n        editor.removeEventListener(\"change\",enableButtonsOnChangeOnce);\n    };\n\n    editor.setTheme(\"ace/theme/monokai\");\n    editor.getSession().setMode(\"ace/mode/html\");\n    editor.on(\"change\",enableButtonsOnChangeOnce);\n    editor.focus();\n\n    $('#rename_file').on('submit',function () {\n        submitFormHideModalGoToLocation($(\"#renameModal\"),$(this));\n        return false;\n    });\n\n    $('#resetContent').find('a.btn-primary').first().click(function(event) {\n        editor.setValue(file_content.val(),-1);\n        cancel_link.removeAttr('data-modal');\n        file_editor_buttons.toggleClass('disabled');\n        editor.on(\"change\",enableButtonsOnChangeOnce);\n    });\n}\n\nfunction initRenameForm(element) {\n    var file_name_span = $('#file_name');\n    var input_span = file_name_span.next().first();\n    var link = file_name_span.find(\"a\").first();\n    var width_span = input_span.next().first();\n    var input = input_span.children().first();\n    var rename_form = $('#rename_file');\n    element.on('click', '#file_name a',function(event){\n        width_span.html(input.val());\n        input.width(width_span.width() + 5);\n        input_span.removeClass('hidden');\n        link.addClass('hidden');\n        input.focus();\n    });\n    $('#new_file_name').keyup(function(event){\n        var input = $(this);\n        if (event.keyCode == 27) {\n            input.focusout();\n        } else {\n            width_span.html(input.val());\n            input.width(width_span.width() + 5);\n        }\n    });\n    $('#new_file_name').focusout(function(event){\n        width_span.html(input.val());\n        input.width(width_span.width() + 5);\n        input_span.addClass('hidden');\n        link.removeClass('hidden');\n        rename_form[0].reset();\n    });\n}\n\nfunction initEditorPage(element) {\n    var file_content = $('#file_content');\n    var editor = ace.edit(\"editor\");\n    initVariableList(editor);\n    initShowLinesCheckBox(editor);\n    initSaveModal(editor,file_content);\n    initCancelModal();\n    initEditor(editor,file_content);\n    initRenameForm(element);\n}\n\nfunction initCollapse(element) {\n    element.on('show hidden','.collapse',function(event) {\n        var that = $(this);\n        var tr = that.closest('tr').first();\n        tr.swap_class('toggle');\n        var link = element.find('[data-target=\"#' + that.attr('id') + '\"]');\n        link.find('[data-swap]').swap_class('toggle');\n        event.stopPropagation(); //To stop the event from closing parents\n    });\n}\n\nfunction initCopyModal(element) {\n    var modal = $('#copyModal');\n    var button = modal.find('.btn-primary').first();\n    modal.on('shown', function() {\n        $(this).find(':input:first').focus();\n    });\n    modal.on('hidden', function() {\n        $(this).data('modal').$element.removeData();\n    });\n    button.off(\"click\");\n    button.click(function(event) {\n        var form = modal.find(\"#copyModalForm\");\n        submitFormHideModal(modal,form);\n    });\n\n    element.on('submit',\"#copyModalForm\",function () {\n        submitFormHideModal(modal,$(this));\n        return false;\n    });\n}\n\nfunction submitFormHideModalGoToLocation(modal,form) {\n    $.ajax({\n        'async' : false,\n        'url'   : form.attr('action'),\n        'type'  : form.attr('method') || \"POST\",\n        'data'  : form.serialize()\n        })\n        .always(function()  {\n            modal.modal('hide');\n        })\n        .done(function(data, textStatus, jqXHR) {\n            location.hash = jqXHR.getResponseHeader('Location');\n        })\n        .fail(function(jqXHR) {\n            $(\"body,html\").animate({scrollTop:0}, 'fast');\n            var status_msg = getStatusMsg(jqXHR);\n            showError($('#section h2'), status_msg);\n        });\n}\n\nfunction initNewFileModal(element) {\n    var modal = $('#newFileModal');\n    var button = modal.find('.btn-primary').first();\n    modal.on('hidden',function() {\n        $(this).data('modal').$element.removeData();\n    });\n    modal.on('shown', function() {\n        $(this).find(':input:first').focus();\n    });\n    button.off(\"click\");\n    button.click(function(event) {\n        var form = modal.find(\"#newFileModalForm\");\n        submitFormHideModalGoToLocation(modal,form);\n        return false;\n    });\n    element.on('submit',\"#newFileModalForm\",function () {\n        submitFormHideModalGoToLocation(modal,$(this));\n        return false;\n    });\n}\n\nfunction disabledLinks(element) {\n    element.on('click','.disabled',function() { return false;});\n}\n\nfunction initIndexPage(element) {\n}\n\nfunction initCreatePage(element) {\n    var form = element.find(\"#create_profile\");\n    var saveBtn = form.find('.btn-primary').first();\n    saveBtn.off(\"click\");\n    saveBtn.click(function(event) {\n        var valid = isFormValid(form);\n        if(!valid) {\n            $(\"body,html\").animate({scrollTop:0}, 'fast');\n        }\n        return valid;\n    });\n\n    var modal = $('#createProfile');\n    var confirmationBtn = modal.find('.btn-primary').first();\n    confirmationBtn.off(\"click\");\n    confirmationBtn.click(function(event) {\n        submitFormHideModalGoToLocation(modal, form);\n        return false;\n    });\n    initReadPage(element);\n}\n\nfunction initReadPage(element) {\n    updateDynamicRowsAfterRemove($('#locale'));\n    updateDynamicRowsAfterRemove($('#filter'));\n    $('#locale, #sources').on('admin.added','tr', function(event) {\n        var row = $(this);\n        var siblings = row.siblings(':not(.hidden)');\n        var selected_options = siblings.find(\"select option:selected\");\n        var select = row.find(\"select\");\n        select.find(\"option:selected\").removeAttr(\"selected\");\n        var options = select.find('option[value!=\"\"]');\n        // Select the next option that was not yet selected\n        options.each(function(index,element) {\n            var selector = '[value=\"' + element.value + '\"]';\n            if(selected_options.filter(selector).length === 0) {\n                $(element).attr(\"selected\", \"selected\");\n                return false;\n            }\n        });\n\n        // If all options have been added, remove the add button\n        var rows = row.siblings(':not(.hidden)').addBack();\n        if (rows.length == options.length) {\n            rows.find('[href=\"#add\"]').addClass('hidden');\n        }\n    });\n    // When selecting an exclusive source, remove all other sources\n    $('#sources').on('change', 'select', function(event) {\n        var that = $(this);\n        var tr = that.closest('tr');\n        if (that.find(':selected').attr('data-source-class') == 'exclusive') {\n            tr.siblings(':not(.hidden)').find('[href=\"#delete\"]').click();\n            tr.find('[href=\"#add\"]').addClass('hidden');\n        } else {\n            tr.find('[href=\"#add\"]').removeClass('hidden');\n        }\n    });\n    $('#filter').on('change', 'select[name$=\".type\"]', function(event) {\n        var type_input = $(event.currentTarget);\n        updateFilterMatchInput(type_input, false);\n    });\n    $('[id$=\"Empty\"]').on('click', '[href=\"#add\"]', function(event) {\n        var match = /(.+)Empty/.exec(event.delegateTarget.id);\n        var id = match[1];\n        var emptyId = match[0];\n        $('#'+id).trigger('addrow');\n        $('#'+emptyId).addClass('hidden');\n        return false;\n    });\n    $('select[name$=\".type\"]:not(:disabled)').each(function(i,e){\n        updateFilterMatchInput($(e),true);\n    });\n}\n\nfunction updateFilterMatchInput(type_input, keep_value) {\n    var match_input = type_input.next();\n    var type_value = type_input.val();\n    var match_input_template_id = '#' + type_value + \"_filter_match\";\n    var match_input_template = $(match_input_template_id);\n    if ( match_input_template.length === 0) {\n        match_input_template = $('#default_filter_match');\n    }\n    if ( match_input_template.length ) {\n        changeInputFromTemplate(match_input, match_input_template, keep_value);\n        if (type_value == \"switch\") {\n            type_input.next().typeahead({\n                source: searchSwitchesGenerator($('#section h2')),\n                minLength: 2,\n                items: 11,\n                matcher: function(item) { return true; }\n            });\n        }\n    }\n}\n\nfunction initTemplatesPage(element) {\n    initCopyModal(element);\n    initCollapse(element);\n    initNewFileModal(element);\n}\n\nfunction connectionProfileGlobalInit(element) {\n    initWidgets(element.find('.chzn-select'));\n    disabledLinks(element);\n}\n\n$('#section').on('section.loaded',function(event) {\n    var initializers = [\n        {id : \"#connection_profile_file_editor\", initializer: initEditorPage},\n        {id : \"#connection_profile_files\", initializer: initTemplatesPage },\n        {id : \"#connection_profile_index\", initializer: initIndexPage },\n        {id : \"#connection_profile_create\", initializer: initCreatePage },\n        {id : \"#connection_profile_read\", initializer: initReadPage }\n    ];\n    for (var i = 0; i < initializers.length; i++) {\n        var initializer = initializers[i];\n        var element = $(initializer.id);\n        if (element.length) {\n            connectionProfileGlobalInit(element);\n            initializer.initializer(element);\n        }\n    }\n\n});\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\nvar domainView;\n$(function() { // DOM ready\n    var items = new Domains();\n    domainView = new DomainView({ items: items, parent: $('#section') });\n});\n\n/*\n * The FloatingDevices class defines the operations available from the controller.\n */\nfunction Domains() {\n}\n\nDomains.prototype = new Items();\nDomains.prototype.id  = '#domains';\nDomains.prototype.formName  = 'modalDomain';\nDomains.prototype.modalId   = '#modalDomain';\nDomains.prototype.createSelector = \".createDomain\";\n\n\nfunction DomainView(options) {\n    ItemView.call(this,options);\n    var that = this;\n    this.parent = options.parent;\n    this.items = options.items;\n\n    var id = this.items.id;\n\n    options.parent.off('click', id + ' [href$=\"/delete\"]');\n\n    var delete_item = $.proxy(this.deleteItem, this);\n    options.parent.on('click', id + ' [href$=\"/delete\"]', delete_item);\n\n    var save_and_join = $.proxy(this.updateAndJoinDomain, this);\n    options.parent.on('click', '#saveAndJoinDomain', save_and_join);\n}\n\nDomainView.prototype = (function(){\n    function F(){}\n    F.prototype = ItemView.prototype;\n    return new F();\n})();\n\nDomainView.prototype.constructor = ItemView;\n\nDomainView.prototype.showWait = function(title){\n  var that = this;\n  $('#modalDomainWait h3').html(title); \n  $('#domainProgressBar').css('width', '1%');\n  $('#modalDomainWait').modal('show');\n};\n\nDomainView.prototype.updateAndJoinDomain = function(e) {\n  e.preventDefault();\n\n  var that = this;\n  var target = $(e.target);\n  var form = target.closest('form');\n  var table = $(this.items.id);\n  var btn = form.find('.btn');\n  var modal = form.closest('.modal');\n  var valid = isFormValid(form);\n  if (valid) {\n      var modal_body = modal.find('.modal-body').first();\n      resetAlert(modal_body);\n      id_input = modal_body.find('#id');\n      id_value = id_input.val();\n      if (!id_value.match(/^[a-zA-Z0-9]+$/)) {\n          showError(modal_body, \"The id is invalid. The id can only contain alphanumeric characters.\");\n          return;\n      }\n\n      form.find('tr.hidden :input').attr('disabled', 'disabled');\n      modal.modal('hide');\n      that.showWait(\"The server is currently joining the domain\");\n      this.items.post({\n          url: target.attr('href'),\n          data: form.serialize(),\n          always: function() {\n              // Restore hidden/template rows\n              form.find('tr.hidden :input').removeAttr('disabled');\n              btn.button('reset');\n              $('#modalDomainWait').modal('hide');\n          },\n          success: function(data) {\n              var content = $('<div></div>');\n              content.append('<h3>Result of the domain join</h3>'); \n              content.append($('<pre>' + data.items.join_output + '</pre>'));\n              that.showResultModal(content); \n              that.list();\n          },\n          errorSibling: $('#section')\n      });\n  }\n};\n\nDomainView.prototype.showResultModal = function(title, content){\n  var self = this;\n  \n  $('#modalDomainInfo .modal-header h3').html(title);\n  $('#modalDomainInfo .modal-body').html(content);\n  $('#modalDomainInfo').modal('show');\n}; \n\nDomainView.prototype.deleteItem = function(e) {\n  var self = this;\n  var original_event = e;\n  e.preventDefault();\n  if ($(this).hasClass('disabled'))\n      return false;\n  var link = $(this);\n  var url = link.attr('href');\n  var row = link.closest('tr');\n  var cells = row.find('td');\n  var name = $(cells[1]).text();\n  if (!name) name = $(cells[0]).text();\n  var modal = $('#deleteItem');\n  var confirm_link = modal.find('a.btn-primary').first();\n  modal.find('h3 span').html(name);\n  modal.modal('show');\n  confirm_link.off('click');\n  confirm_link.click(function(e) {\n      e.preventDefault();\n      confirm_link.button('loading');\n\n      e.preventDefault();\n      var table = $(self.items.id);\n      var btn = $(original_event.target);\n      var row = btn.closest('tr');\n      var url = btn.attr('href');\n      self.items.get({\n          url: url,\n          always: function(){\n            confirm_link.button('reset');\n            modal.modal('hide');\n          },\n          success: function(data) {\n              showSuccess(table, data.status_msg);\n              self.list(e);\n          },\n          errorSibling: table\n      });\n\n  });\n};\n\nDomainView.prototype.list = function() {\n    var table = $('#domains');\n    this.listRefresh(table.attr('data-list-uri'));\n};\n\nDomainView.prototype.listRefresh = function(list_url) {\n    var table = $('#domains');\n    var that = this;\n    table.fadeTo('fast',0.5,function() {\n        that.items.get({\n            url: list_url,\n            always: function() {\n                table.fadeTo('fast',1.0);\n            },\n            success: function(data) {\n                table.replaceWith(data);\n            },\n            errorSibling: $('#domains')\n        });\n    });\n};\n\nDomainView.prototype.setPassword = function(domain,callback) {\n  var that = this;\n  var modal = $('#modalDomainSetPassword-'+domain);\n  var form = $('#modalDomainSetPassword-'+domain+' form');\n  form.submit(function(evt){\n    evt.preventDefault();\n    $.ajax({\n        'url'   : form.attr('action'),\n        'type'  : \"POST\",\n        'data'  : form.serialize(),\n        })\n        .done(function(data) {\n            modal.modal('hide');     \n            form.find('input[name=\"username\"]').val('');\n            form.find('input[name=\"password\"]').val('');\n            callback();\n        })\n        .fail(function(jqXHR) {\n            $(\"body,html\").animate({scrollTop:0}, 'fast');\n            var status_msg = getStatusMsg(jqXHR);\n            form.find('input[name=\"username\"]').val('');\n            form.find('input[name=\"password\"]').val('');\n            showError($('#section h2'), status_msg);\n        });\n    return false;\n  });\n  modal.modal('show');\n};\n\n$(document).ready(function(){\n  $('#section').on('click', '.rejoin_domain', function(event){\n    var that = this;\n    event.preventDefault();\n    var domain_name = $(event.target).parent().parent().children().children().html();\n    domainView.setPassword(domain_name, function(){\n      var view = domainView;\n      var jbtn = $(that);\n      var initial_content = jbtn.html();\n      jbtn.attr('disabled', 'disabled');\n      // needs to be i18ned \n      jbtn.html(\"Rejoining domain\");\n      domainView.showWait(\"The server is rejoining the domain.\");\n      $.ajax({\n          'url'   : jbtn.attr('href'),\n          'type'  : \"GET\",\n          })\n          .done(function(data) {\n              $(\"body,html\").animate({scrollTop:0}, 'fast');\n              var content = $('<div></div>');\n              content.append('<h3>Result of the domain leave</h3>'); \n              content.append($('<pre>'+data.items.leave_output+'</pre>'));\n              content.append('<h3>Result of the domain join</h3>'); \n              content.append($('<pre>'+data.items.join_output+'</pre>'));\n              $('#modalDomainWait').modal('hide');\n              domainView.showResultModal(content); \n              view.list();\n              jbtn.html(initial_content);\n              jbtn.removeAttr('disabled');\n          })\n          .fail(function(jqXHR) {\n              $(\"body,html\").animate({scrollTop:0}, 'fast');\n              var status_msg = getStatusMsg(jqXHR);\n              showError($('#section h2'), status_msg);\n              jbtn.html(initial_content);\n              jbtn.removeAttr('disabled');\n          });\n    });\n    return false;\n  });\n\n  $('#section').on('click', '#refresh_domains', function(event){\n    \n    event.preventDefault();\n    var initial_content = $('#refresh_domains').html();\n    $('#refresh_domains').attr('disabled', 'disabled');\n    // need to be i18ned \n    $('#refresh_domains').html(\"Refreshing domains\");\n    domainView.showWait(\"The server is refreshing the configuration.\");\n    $.ajax({\n        'url'   : $('#refresh_domains').attr('href'),\n        'type'  : \"GET\",\n        })\n        .done(function(data) {\n            $(\"body,html\").animate({scrollTop:0}, 'fast');\n            $('#modalDomainWait').modal('hide');\n            showSuccess($('#section h2'), data.status_msg);\n            $('#refresh_domains').html(initial_content);\n            $('#refresh_domains').removeAttr('disabled');\n        })\n        .fail(function(jqXHR) {\n            $(\"body,html\").animate({scrollTop:0}, 'fast');\n            var status_msg = getStatusMsg(jqXHR);\n            showError($('#section h2'), status_msg);\n            $('#refresh_domains').html(initial_content);\n            $('#refresh_domains').removeAttr('disabled');\n        });\n    });\n\n\n  setInterval(function(){\n    var width = $('#domainProgressBar').width();\n    if(!width && width !== 0) return; \n    var parentWidth = $('#domainProgressBar').offsetParent().width();\n    width = 100*width/parentWidth;\n    if(width == 100){\n      width = 0;\n    }\n    else{\n      width += 10;\n      if(width > 100){\n        width = 100;\n      }\n    }\n    $('#domainProgressBar').css('width', width+'%');\n  }, 15000);\n\n});\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\n$(function() { // DOM ready\n    var items = new Items();\n    var view = new ItemView({ items: items, parent: $('#section') });\n});\n\n/*\n * The Items class defines the operations available from the controller.\n */\nfunction Items() {\n}\n\nItems.prototype.id = \"#items\";\n\nItems.prototype.formName = \"modalItem\";\n\nItems.prototype.modalId = \"#modalItem\";\n\nItems.prototype.createSelector = \".createItem\";\n\nItems.prototype.get = function(options) {\n    $.ajax({\n        url: options.url\n    })\n        .always(options.always)\n        .done(options.success)\n        .fail(function(jqXHR) {\n            var status_msg = getStatusMsg(jqXHR);\n            showPermanentError(options.errorSibling, status_msg);\n        });\n};\n\nItems.prototype.post = function(options) {\n    $.ajax({\n        url: options.url,\n        type: 'POST',\n        data: options.data\n    })\n        .always(options.always)\n        .done(options.success)\n        .fail(function(jqXHR) {\n            var status_msg = getStatusMsg(jqXHR);\n            showPermanentError(options.errorSibling, status_msg);\n        });\n};\n\n/*\n * The ItemView class defines the DOM operations from the Web interface.\n */\nfunction ItemView(options) {\n    var that = this;\n    this.parent = options.parent;\n    var items = options.items;\n    this.items = items;\n    this.disableToggle = false;\n    var id = items.id;\n    var formName = items.formName;\n\n    // Display the switch in a modal\n    var read = $.proxy(this.readItem, this);\n    options.parent.on('click', id + ' .item [href$=\"/read\"]', read);\n    options.parent.on('click', id + ' [href$=\"/clone\"]', read);\n    options.parent.on('click', items.createSelector, read);\n\n    // Save the modifications from the modal\n    var update = $.proxy(this.updateItem, this);\n    options.parent.on('submit', 'form[name=\"' + formName + '\"]', update);\n\n    // Delete the switch\n    var delete_item = $.proxy(this.deleteItem, this);\n    options.parent.on('click', id + ' [href$=\"/delete\"]', delete_item);\n\n    var list_items = $.proxy(this.listItems, this);\n    options.parent.on('click', id + ' [href*=\"/list\"]', list_items);\n    //\n    // Save the modifications from the modal\n    var search = $.proxy(this.search, this);\n    options.parent.on('submit', 'form[name=\"search\"]', search);\n    //\n    // Save the modifications from the modal\n    var resetSearch = $.proxy(this.resetSearch, this);\n    options.parent.on('reset', 'form[name=\"search\"]', resetSearch);\n\n    var search_next = $.proxy(this.searchNext, this);\n    options.parent.on('click', id + ' [href*=\"/search\"]', search_next);\n}\n\nItemView.prototype.readItem = function(e) {\n    e.preventDefault();\n\n    var that = this;\n    var modal = $(this.items.modalId);\n    var section = $('#section');\n    var target = e.target;\n    if (target.nodeName != 'A')\n        target = target.parentNode;\n    section.loader();\n    section.fadeTo('fast', 0.5);\n    modal.empty();\n    $('.chosen-drop').remove(); // fixes a chzn bug with optgroups\n    this.items.get({\n        url: $(target).attr('href'),\n        always: function() {\n            section.stop();\n            section.fadeTo('fast', 1.0, function() {\n                section.loader('hide');\n            });\n        },\n        success: function(data) {\n            modal.append(data);\n            modal.find('.chzn-select').chosen({width: ''});\n            modal.find('.chzn-deselect').chosen({allow_single_deselect: true, width: ''});\n            fixChosenClipping(modal.find('.chzn-select, .chzn-deselect'));\n            modal.one('shown', function() {\n                modal.find(':input:visible').first().focus();\n            });\n            modal.modal({ shown: true });\n        },\n        errorSibling: section.find('h2').first()\n    });\n};\n\nItemView.prototype.updateItem = function(e) {\n    e.preventDefault();\n\n    var that = this;\n    var form = $(e.target);\n    var table = $(this.items.id);\n    var btn = form.find('.btn-primary');\n    var modal = form.closest('.modal');\n    var valid = isFormValid(form);\n    if (valid) {\n        var modal_body = modal.find('.modal-body').first();\n        resetAlert(modal_body);\n        btn.button('loading');\n        form.find('tr.hidden :input').attr('disabled', 'disabled');\n        this.items.post({\n            url: form.attr('action'),\n            data: form.serialize(),\n            always: function() {\n                // Restore hidden/template rows\n                form.find('tr.hidden :input').removeAttr('disabled');\n                btn.button('reset');\n            },\n            success: function(data) {\n                modal.modal('toggle');\n                showSuccess(table, data.status_msg);\n                that.list();\n            },\n            errorSibling: modal_body.children().first()\n        });\n    }\n};\n\nItemView.prototype.list = function() {\n    var table = $(this.items.id);\n    this.items.get({\n        url: table.attr('data-list-uri'),\n        success: function(data) {\n            table.html(data);\n        },\n        errorSibling: table\n    });\n};\n\nItemView.prototype.deleteItem = function(e) {\n    e.preventDefault();\n    var table = $(this.items.id);\n    var btn = $(e.target);\n    var that = this;\n    var row = btn.closest('tr');\n    var url = btn.attr('href');\n    this.items.get({\n        url: url,\n        success: function(data) {\n            showSuccess(table, data.status_msg);\n            that.list(e);\n        },\n        errorSibling: table\n    });\n    return false;\n};\n\nItemView.prototype.list = function() {\n    var table = $(this.items.id);\n    this.listRefresh(table.attr('data-list-uri'));\n};\n\nItemView.prototype.listItems = function(e) {\n    e.preventDefault();\n    var link = $(e.target);\n    this.listRefresh( link.attr('href'));\n};\n\nItemView.prototype.listRefresh = function(list_url) {\n    var table = $(this.items.id);\n    var that = this;\n    table.fadeTo('fast',0.5,function() {\n        that.items.get({\n            url: list_url,\n            always: function() {\n                table.fadeTo('fast',1.0);\n            },\n            success: function(data) {\n                table.replaceWith(data);\n            },\n            errorSibling: table\n        });\n    });\n};\n\n\nItemView.prototype.resetSearch = function(e) {\n    e.preventDefault();\n    this.list();\n    return false;\n};\n\nItemView.prototype.search = function(e) {\n    e.preventDefault();\n    var form = $(e.target);\n    var url = form.attr('action');\n    this.searchRefresh(url, form);\n    return false;\n};\n\nItemView.prototype.searchNext = function(e) {\n    e.preventDefault();\n    var form = $(\"#search\");\n    var link = $(e.target);\n    var url = link.attr('href');\n    this.searchRefresh(url,form);\n    return false;\n};\n\nItemView.prototype.searchRefresh = function(search_url,form) {\n    var table = $(this.items.id);\n    var that = this;\n    table.fadeTo('fast', 0.5, function() {\n        that.items.post({\n            url: search_url,\n            data: form.serialize(),\n            always: function() {\n                table.fadeTo('fast',1.0);\n            },\n            success: function(data) {\n                table.replaceWith(data);\n            },\n            errorSibling: table\n        });\n    });\n    return false;\n};\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\n$(function() { // DOM ready\n    var items = new Pfdetects();\n    var view = new PfdetectView({ items: items, parent: $('#section') });\n});\n\n/*\n * The Pfdetects class defines the operations available from the controller.\n */\nvar Pfdetects = function() {\n};\n\nPfdetects.prototype = new Items();\n\nPfdetects.prototype.id  = '#pfdetects';\n\nPfdetects.prototype.formName  = 'modalPfdetect';\n\nPfdetects.prototype.modalId   = '#modalPfdetect';\n\nPfdetects.prototype.createSelector = \".createPfdetect\";\n\n/*\n * The PfdetectView class defines the DOM operations from the Web interface.\n */\n\n\nvar PfdetectView = function(options) {\n    ItemView.call(this, options);\n    var that = this;\n    this.parent = options.parent;\n    var items = options.items;\n    this.items = items;\n    var id = items.id;\n    var formName = items.formName;\n    options.parent.off('click', id + ' [href$=\"/clone\"]');\n\n    var showTestRegex = $.proxy(this.showTestRegex, this);\n    options.parent.on('show', '#test-regex', showTestRegex);\n\n    var toggleResults = $.proxy(this.toggleResults, this);\n    options.parent.on('shown', '#test-regex-results .collapse', toggleResults);\n    options.parent.on('hidden', '#test-regex-results .collapse', toggleResults);\n\n    var testRegex = $.proxy(this.testRegex, this);\n    options.parent.on('click', '#test-regex-btn', testRegex);\n\n    var handleChangeApiMethod = this.handleChangeApiMethod;\n    options.parent.on('change', 'form[name=\"modalPfdetect\"] [name$=\".api_method\"]', handleChangeApiMethod);\n};\n\nPfdetectView.prototype = (function(){\n    function F(){}\n    F.prototype = ItemView.prototype;\n    return new F();\n})();\n\nPfdetectView.prototype.constructor = PfdetectView;\n\nPfdetectView.prototype.updateItem = function(e) {\n    e.preventDefault();\n\n    var that = this;\n    var form = $(e.target);\n    var table = $(this.items.id);\n    var section = $('#section');\n    var btn = form.find('.btn-primary');\n    var valid = isFormValid(form);\n    if (valid) {\n        var alert_element = form.find('h2').first();\n        btn.button('loading');\n        this.items.post({\n            url: form.attr('action'),\n            data: form.serialize(),\n            always: function() {\n                // Restore hidden/template rows\n                btn.button('reset');\n            },\n            success: function(data, textStatus, jqXHR) {\n                var redirect = jqXHR.getResponseHeader('Location');\n                showSuccess(alert_element, data.status_msg);\n                if (redirect) {\n                    location.hash = redirect;\n                }\n            },\n            errorSibling: alert_element\n        });\n    }\n};\n\nPfdetectView.prototype.toggleResults = function(e) {\n    var div = $(e.currentTarget);\n    var icon = $('a[data-target=\"#'+ div.attr(\"id\") + '\"] i');\n    if (icon.length) {\n        icon.toggleClass(\"icon-minus-circle\", 1);\n    }\n};\n\nPfdetectView.prototype.testRegex = function(e) {\n    e.preventDefault();\n\n    var that = this;\n    var btn = $(e.target);\n    var form = $(btn.closest('form').first());\n    var valid = isFormValid(form);\n    if (valid) {\n        var action = btn.attr(\"data-test-action\");\n        var section = $('#section');\n        btn.button('loading');\n        this.items.post({\n            url: action,\n            data: form.serialize(),\n            always: function() {\n                // Restore hidden/template rows\n                btn.button('reset');\n            },\n            success: function(data) {\n                showSuccess(section.find('h2').first(), \"Passed\");\n                $('#test-regex-results').html(data);\n            },\n            errorSibling: section.find('h2').first()\n        });\n    }\n    return false;\n};\n\nPfdetectView.prototype.showTestRegex = function(e) {\n    $('textarea[name=\"loglines\"]').removeAttr('disabled');\n};\n\nPfdetectView.prototype.handleChangeApiMethod = function(e) {\n    var search_input = $(e.currentTarget);\n    var api_parameters_input = search_input.next();\n    var search_type = search_input.val();\n    var api_parameters_id = '#' + search_type + \"_api_parameters\";\n    var api_parameters_template = $(api_parameters_id);\n    if (api_parameters_template.length === 0) {\n        api_parameters_template = $('#default_api_parameters');\n    }\n    if (api_parameters_template.length) {\n        changeInputFromTemplate(api_parameters_input, api_parameters_template);\n    }\n};\n\n\nfunction submitFormGoToLocation(form) {\n    $.ajax({\n        'async' : false,\n        'url'   : form.attr('action'),\n        'type'  : form.attr('method') || \"POST\",\n        'data'  : form.serialize()\n        })\n        .done(function(data, textStatus, jqXHR) {\n            location.hash = jqXHR.getResponseHeader('Location');\n        })\n        .fail(function(jqXHR) {\n            $(\"body,html\").animate({scrollTop:0}, 'fast');\n            var status_msg = getStatusMsg(jqXHR);\n            showError($('#section h2'), status_msg);\n        });\n}\n\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\n$('#section').on('click', '[id$=\"Empty\"]', function(event) {\n  event.preventDefault();\n  var match = /(.+)Empty/.exec($(event.target).closest('.unwell').attr('id'));\n  var id = match[1];\n  var emptyId = match[0];\n  $('#'+id).trigger('addrow');\n  $('#'+emptyId).addClass('hidden');\n  return false;\n});\n\n$('#section').on('submit', 'form[name=\"formItem\"]', function(e) {\n  e.preventDefault();\n\n  var form = $(this),\n  btn = form.find('.btn-primary'),\n  valid = isFormValid(form);\n\n  $('select[name$=\".type\"]:not(:disabled)').each(function(i,e){\n    if($(e).val() == \"Select an option\"){\n      valid = false;\n      showPermanentError(form, \"Please select a valid action.\");\n    }\n  });\n\n  if (valid) {\n    btn.button('loading');\n    resetAlert($('#section'));\n    $.ajax({\n        type: 'POST',\n        url: form.attr('action'),\n        data: form.serialize()\n    }).always(function() {\n        btn.button('reset');\n    }).done(function(data, textStatus, jqXHR) {\n        showSuccess(form, \"Saved\");\n        window.location.hash = \"#config/portal_module/\"+form.find('input[name=\"id\"]').val()+\"/read\";\n    }).fail(function(jqXHR) {\n        $(\"body,html\").animate({scrollTop:0}, 'fast');\n        var status_msg = getStatusMsg(jqXHR);\n        showPermanentError(form, status_msg);\n    });\n  }\n});\n\n$('#section').on('click', '.delete-portal-module', function(e){\n  e.preventDefault();\n  var button = $(e.target);\n  button.button('loading');\n  $.ajax({\n        type: 'GET',\n        url: button.attr('href'),\n    }).always(function() {\n    }).done(function(data, textStatus, jqXHR) {\n        showSuccess(button.closest('.table'), \"Deleted\");\n        button.closest('tr').remove();\n    }).fail(function(jqXHR) {\n        button.button('reset');\n        $(\"body,html\").animate({scrollTop:0}, 'fast');\n        var status_msg = getStatusMsg(jqXHR);\n        showPermanentError(button.closest('.table'), status_msg);\n    });\n  return false; \n});\n\n$('#section').on('click', '.expand', function(e){\n  e.preventDefault();\n  $(e.target).hide(function(){\n    $($(e.target).attr('data-expand')).slideDown();\n  });\n  return false;  \n});\n\n$('#section').on('change', '#actions select[name$=\".type\"]', function(event) {\n  var type_input = $(event.currentTarget);\n  updateActionMatchInput(type_input,false);\n});\n\n$('#section').on('click', '#actionsContainer a[href=\"#add\"]', function(event) {\n  setTimeout(initActionMatchInput, 3000);\n});\n\n$('#section').on('section.loaded',function(event) {\n    var dataEl = document.getElementById('modulesTreeData');\n\n    if (dataEl) {\n        var data = JSON.parse(dataEl.textContent || dataEl.innerHTML);\n        $('#modulesTree').tree({\n            data: data\n        });\n        $('#modulesTree').bind(\n            'tree.click',\n            function(event){\n                var node = event.node;\n                window.location.hash = '#config/portal_module/'+node.id+'/read';\n            }\n        );\n    }\n\n    initActionMatchInput();\n});\n\nfunction initActionMatchInput() {\n  $('select[name$=\".type\"]:not(:disabled)').each(function(i,e){\n      updateActionMatchInput($(e),true);\n  });\n}\n\nfunction updateActionMatchInput(type_input, keep) {\n    var match_input = type_input.next();\n    var type_value = type_input.val();\n    var match_input_template_id = '#' + type_value + \"_action_match\";\n    var match_input_template = $(match_input_template_id);\n    if ( match_input_template.length === 0) {\n        match_input_template = $('#default_action_match');\n    }\n    if ( match_input_template.length ) {\n        changeInputFromTemplate(match_input, match_input_template, keep);\n        if (type_value == \"switch\") {\n            type_input.next().typeahead({\n                source: searchSwitchesGenerator($('#section h2')),\n                minLength: 2,\n                items: 11,\n                matcher: function(item) { return true; }\n            });\n        }\n    }\n}\n\n","$(function() { // DOM ready\n\n    /* Delete a source */\n    $('#section').on('click', '.sources [href*=\"/delete\"]', function(event) {\n        if ($(this).hasClass('disabled'))\n            return false;\n        var url = $(this).attr('href');\n        var row = $(this).closest('tr');\n        var name = row.find('[href*=\"/read\"]').first().text();\n        var modal = $('#deleteSource');\n        var confirm_link = modal.find('a.btn-primary').first();\n        modal.find('h3 span').html(name);\n        modal.modal({ show: true });\n        confirm_link.off('click');\n        confirm_link.click(function() {\n            $.ajax(url)\n                .always(function() {\n                    modal.modal('hide');\n                })\n                .done(function(data) {\n                    $(window).hashchange();\n                })\n                .fail(function(jqXHR) {\n                    $(\"body,html\").animate({scrollTop:0}, 'fast');\n                    var status_msg = getStatusMsg(jqXHR);\n                    showError($('#section h2'), status_msg);\n                });\n            return false;\n        });\n\n        return false;\n    });\n\n    /* Test a source */\n    $('#section').on('click', '#testSource', function(e) {\n        e.preventDefault();\n\n        var btn = $(this);\n        var form = btn.closest('form');\n        var valid = isFormValid(form);\n\n        resetAlert($('#section'));\n        if (valid) {\n            $.ajax({\n                type: 'POST',\n                url: btn.attr('href'),\n                data: form.serialize()\n            }).done(function(data) {\n                showSuccess(form, data.status_msg);\n            }).fail(function(jqXHR) {\n                var status_msg = getStatusMsg(jqXHR);\n                showPermanentError(form, status_msg);\n            });\n        }\n    });\n\n    /* Create a source */\n    $('#section').on('submit', 'form[name=\"create_source\"]', function(e) {\n        e.preventDefault();\n\n        var form = $(this),\n            valid = isFormValid(form);\n\n        if (valid) {\n            resetAlert($('#section'));\n            $.ajax({\n                type: 'POST',\n                url: form.attr('action'),\n                data: form.serialize()\n            }).done(function(data, textStatus, jqXHR) {\n                location.hash = jqXHR.getResponseHeader('Location');\n            }).fail(function(jqXHR) {\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                var status_msg = getStatusMsg(jqXHR);\n                showPermanentError(form, status_msg);\n            });\n            // TODO: find a way to change the location hash without reloading the page\n            // location.hash = 'authentication';\n        }\n    });\n\n    /* Save a source */\n    $('#section').on('submit', 'form[name=\"source\"]', function(e) {\n        e.preventDefault();\n\n        var form = $(this),\n        btn = form.find('.btn-primary'),\n        valid = isFormValid(form);\n\n        if (valid) {\n            btn.button('loading');\n            resetAlert($('#section'));\n            $.ajax({\n                type: 'POST',\n                url: form.attr('action'),\n                data: form.serialize()\n            }).always(function() {\n                btn.button('reset');\n            }).done(function(data, textStatus, jqXHR) {\n                $('#section').fadeOut('fast', function() {\n                    // Refresh the complete section\n                    $(this).empty();\n                    $(this).html(data);\n                    $(this).fadeIn('fast', function() {\n                        $('.chzn-select').chosen();\n                        $('#id').focus();\n                    });\n                });\n            }).fail(function(jqXHR) {\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                var status_msg = getStatusMsg(jqXHR);\n                showPermanentError(form, status_msg);\n            });\n            // TODO: find a way to change the location hash without reloading the page\n            // location.hash = 'authentication';\n        }\n    });\n\n    /* Show a rule */\n    $('#section').on('click', '#sourceRules a:not(.btn-icon)', function(event) {\n        var modal = $('#modalRule');\n        var url = $(this).attr('href');\n        var section = $('#section');\n        var loader = section.prev('.loader');\n        loader.show();\n        section.fadeTo('fast', 0.5);\n        modal.empty();\n        $.ajax(url)\n            .always(function(){\n                loader.hide();\n                section.stop();\n                section.fadeTo('fast', 1.0);\n            })\n            .done(function(data) {\n                modal.append(data);\n                modal.one('shown', function() {\n                    $('#id').focus();\n                });\n                modal.modal({ shown: true });\n\n                var rule_class = $('#class');\n                var actions_table = $('#ruleActions');\n                var action_row = actions_table.children('tbody').children('tr');\n                if (rule_class.find(':selected').attr('value') == 'administration') {\n                    action_row.find('option[data-rule-class=\"administration\"]').removeClass('hidden');\n                    action_row.find('option[data-rule-class=\"authentication\"]').addClass('hidden');\n                } else if (rule_class.find(':selected').attr('value') == 'authentication') {\n                    action_row.find('option[data-rule-class=\"authentication\"]').removeClass('hidden');\n                    action_row.find('option[data-rule-class=\"administration\"]').addClass('hidden');\n                }\n\n            })\n            .fail(function(jqXHR) {\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                var status_msg = getStatusMsg(jqXHR);\n                showError($('#section h3'), status_msg);\n            });\n\n        return false;\n    });\n\n    /* Create a rule */\n    $('#section').on('click', '#createRule', function(event) {\n        var modal = $('#modalRule');\n        var url = $(this).attr('href');\n        var section = $('#section');\n        var loader = section.prev('.loader');\n        loader.show();\n        section.fadeTo('fast', 0.5);\n        modal.empty();\n        $.ajax(url)\n            .always(function(){\n                loader.hide();\n                section.stop();\n                section.fadeTo('fast', 1.0);\n            })\n            .done(function(data) {\n                modal.append(data);\n                modal.one('shown', function() {\n                    $('#id').focus();\n                    $('#class').trigger(\"change\");\n                });\n                modal.modal({ shown: true });\n            })\n            .fail(function(jqXHR) {\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                var status_msg = getStatusMsg(jqXHR);\n                showError($('#section h3'), status_msg);\n            });\n\n        return false;\n    });\n\n    /* Save a rule */\n    $('#section').on('submit', 'form[name=\"rule\"]', function(event) {\n        var form = $(this),\n        btn = form.find('.btn-primary'),\n        modal = $('#modalRule'),\n        modal_body = modal.find('.modal-body').first(),\n        valid = isFormValid(form);\n\n        if (valid) {\n            btn.button('loading');\n            resetAlert(modal_body);\n            // Don't submit hidden/template rows -- serialize will ignore disabled inputs\n            form.find('tr.hidden :input').attr('disabled', 'disabled');\n            $.ajax({\n                type: 'POST',\n                url: form.attr('action'),\n                data: form.serialize()\n            }).always(function() {\n                btn.button('reset');\n            }).done(function(data) {\n                modal.one('hidden', function() {\n                    // Refresh the rules list\n                    $('#sourceRulesEmpty').closest('.control-group').fadeOut('fast', function() {\n                        $(this).empty();\n                        $(this).html(data);\n                        $(this).fadeIn('fast', function() {\n                            $('.chzn-select').chosen({width: ''});\n                        });\n                    });\n                });\n                modal.modal('hide');\n            }).fail(function(jqXHR) {\n                var status_msg = getStatusMsg(jqXHR);\n                showPermanentError(modal_body.children().first(), status_msg);\n                // Restore hidden/template rows\n                form.find('tr.hidden :input').removeAttr('disabled');\n            });\n        }\n\n        return false;\n    });\n\n    /* Update available and configured actions when selecting a rule class */\n    $('#section').on('change', '#class', function(event) {\n        var that = $(this);\n        var table = $('#ruleActions');\n\n        table.find('tr:not(.hidden)').remove();\n\n        var row_model = table.children('tbody').children('.hidden').first();\n        if (that.find(':selected').attr('value') == 'administration') {\n            row_model.find('option[data-rule-class=\"administration\"]').removeClass('hidden');\n            row_model.find('option[data-rule-class=\"administration\"]').removeAttr('disabled');\n            row_model.find('option[data-rule-class=\"authentication\"]').addClass('hidden');\n            row_model.find('option[data-rule-class=\"authentication\"]').attr('disabled', 'disabled');\n        } else if (that.find(':selected').attr('value') == 'authentication') {\n            row_model.find('option[data-rule-class=\"authentication\"]').removeClass('hidden');\n            row_model.find('option[data-rule-class=\"authentication\"]').removeAttr('disabled');\n            row_model.find('option[data-rule-class=\"administration\"]').addClass('hidden');\n            row_model.find('option[data-rule-class=\"administration\"]').attr('disabled', 'disabled');\n        }\n\n        $('#ruleActions tr:not(.hidden) select[name$=type]').each(function() {\n            updateAction($(this), false);\n        });\n        table.trigger(\"addrow\");\n        table.find('tr').find('[href=\"#delete\"]').addClass('hidden');\n\n    });\n\n    /* Initial creation of a rule condition when no condition is defined */\n    $('body').on('click', '#ruleConditionsEmpty [href=\"#add\"]', function(event) {\n        $('#ruleConditions').trigger(\"addrow\");\n        return false;\n    });\n\n    /* Initialize the rule condition and action fields when displaying a rule */\n    $('#section').on('show', '#modalRule', function(event) {\n        if (event.target.id == 'modalRule') {\n            $('#templates').find('option').removeAttr('id');\n            $('#ruleConditions tr:not(.hidden) select[name$=attribute]').each(function() {\n                updateCondition($(this));\n            });\n            $('#ruleActions tr:not(.hidden) select[name$=type]').each(function() {\n                updateAction($(this), true);\n            });\n        }\n    });\n\n    /* Update the rule condition fields when adding a new condition */\n    $('#section').on('admin.added', '#ruleConditions tr', function(event) {\n        var attribute = $(this).find('select[name$=attribute]').first();\n        updateCondition(attribute);\n    });\n\n    /* Update the rule condition fields when changing a condition attribute */\n    $('#section').on('change', '#ruleConditions select[name$=attribute]', function(event) {\n        updateCondition($(this));\n    });\n\n    /* Update the rule action fields when changing an action type */\n    $('#section').on('change', '#ruleActions select[name$=type]', function(event) {\n        updateAction($(this));\n    });\n\n    /* Update the rule action fields when adding a new action */\n    $('#section').on('admin.added', '#ruleActions tr:not(.hidden)', function(event) {\n        var type = $(this).find('select[name$=type]').first();\n        updateAction(type);\n    });\n\n});\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\nvar filtersView;\n$(function() { // DOM ready\n  filtersView = new FiltersView({ parent: $('#section') });\n});\n\nvar FiltersView = function(options) {\n  var that = this;\n  this.parent = options.parent;\n\n  // Save the modifications\n  var update = $.proxy(this.update, this);\n  options.parent.on('submit', '#filtersForm', update);\n  \n  // Revert the modifications\n  var revert = $.proxy(this.revert, this);\n  options.parent.on('click', '#filtersRevert', revert);\n\n  var load = $.proxy(this.setupEditor, this);\n  options.parent.on('section.loaded', load);\n};\n\nFiltersView.prototype.setupEditor = function() {\n  if ($('#editor').length) {\n    this.editor = ace.edit(\"editor\");\n    this.editor.setTheme(\"ace/theme/monokai\");\n    this.editor.getSession().setMode(\"ace/mode/perl\");\n\n    this.disableButtons();\n\n    this.initialValue = this.editor.getValue();\n  }\n};\n\nFiltersView.prototype.revert = function(e){\n  this.editor.setValue(this.initialValue, -1);\n  this.disableButtons();\n};\n\nFiltersView.prototype.disableButtons = function() {\n  $('#filtersForm .btn').addClass('disabled');\n  \n  this.enableButtonsProxy = $.proxy(this.enableButtons, this);\n  this.editor.on(\"change\",this.enableButtonsProxy);\n};\n\nFiltersView.prototype.enableButtons = function() {\n  $('#filtersForm .btn').removeClass('disabled');\n  this.editor.removeEventListener(\"change\",this.enableButtonsProxy);\n};\n\nFiltersView.prototype.update = function(e){\n  var that = this;\n  e.preventDefault();\n\n  var jthis = $(e.target);\n  $.ajax({\n      url: jthis.attr(\"action\"),\n      type: 'POST',\n      data: { content : this.editor.getValue() },\n  })\n  .done(function(data){\n    showSuccess(jthis, data.status_msg);\n    that.initialValue = that.editor.getValue();\n    that.disableButtons();\n  })\n  .fail(function(jqXHR) {\n      var status_msg = getStatusMsg(jqXHR);\n      showPermanentError(jthis, status_msg);\n  });\n\n  return false;\n};\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\n$(function() { // DOM ready\n    var items = new FingerbankDevices();\n    var view = new FingerbankDeviceView({ items: items, parent: $('#section') });\n});\n\n/*\n * The FingerbankDevices class defines the operations available from the controller.\n */\nvar FingerbankDevices = function() {\n};\n\nFingerbankDevices.prototype = new Items();\n\nFingerbankDevices.prototype.id  = '#fingerbankdevices';\n\nFingerbankDevices.prototype.formName  = 'modalFingerbankDevice';\n\nFingerbankDevices.prototype.modalId   = '#modalFingerbankDevice';\n\nFingerbankDevices.prototype.createSelector = \".createFingerbankDevice\";\n\n/*\n * The FingerbankDeviceView class defines the DOM operations from the Web interface.\n */\n\n\nvar FingerbankDeviceView = function(options) {\n    ItemView.call(this,options);\n    var that = this;\n    // Display sub children\n    var showChildren = $.proxy(this.showChildren, this);\n    options.parent.on('click', '#fingerbankdevices [href$=\"/children\"]', showChildren);\n    var read = $.proxy(this.readItem, this);\n    options.parent.on('click', '#fingerbankdevices [href$=\"/add_child\"]', read);\n    options.parent.on('show hidden','.collapse',function(event) {\n        var that = $(this);\n        var tr = that.closest('tr').first();\n        tr.toggleClass('hidden');\n        event.stopPropagation(); //To stop the event from closing parents\n    });\n\n};\n\nFingerbankDeviceView.prototype = (function(){\n    function F(){}\n    F.prototype = ItemView.prototype;\n    return new F();\n})();\n\nFingerbankDeviceView.prototype.constructor = FingerbankDeviceView;\n\nFingerbankDeviceView.prototype.showChildren = function(e) {\n    var that = this;\n    var link = $(e.currentTarget);\n    var href = link.attr(\"href\");\n    var target = link.attr(\"data-target\");\n    var children_div = $(target);\n    var row = children_div.closest(\"tr\");\n    children_div.collapse({toggle: false});\n    if(row.hasClass('hidden')) {\n        this.items.get({\n            url: href,\n            success: function(data) {\n                children_div.find('table').html(data);\n                children_div.collapse('show');\n            },\n            errorSibling: $(that.id)\n        });\n    } else {\n        children_div.collapse('hide');\n    }\n\n    return false;\n};\n","$(function() { // DOM ready\n    $('#section').on('submit','#fingerbankonboard', function(event) {\n        updateSectionFromForm($('#fingerbankonboard'));\n        return false;\n    });\n});\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\n$(function() { // DOM ready\n    var items = new FloatingDevices();\n    var view = new FloatingDeviceView({ items: items, parent: $('#section') });\n});\n\n/*\n * The FloatingDevices class defines the operations available from the controller.\n */\nvar FloatingDevices = function() {\n};\n\nFloatingDevices.prototype = new Items();\n\nFloatingDevices.prototype.id  = '#floatingdevices';\n\nFloatingDevices.prototype.formName  = 'modalFloatingDevice';\n\nFloatingDevices.prototype.modalId   = '#modalFloatingDevice';\n\nFloatingDevices.prototype.createSelector = \".createFloatingDevice\";\n\n/*\n * The FloatingDeviceView class defines the DOM operations from the Web interface.\n */\n\n\nvar FloatingDeviceView = function(options) {\n    ItemView.call(this,options);\n    var that = this;\n    this.parent = options.parent;\n    this.items = options.items;\n\n    // Show the tagged VLANs field when 'trunk port' is checked\n    options.parent.on('change', 'form[name=\"modalFloatingDevice\"] input[name=\"trunkPort\"]', this.toggleTaggedVlan);\n\n    // Initialize the tagged VLANs fields when displaying a floating device\n    options.parent.on('show', '#modalFloatingDevice', function(e) {\n        var checkbox = $('form[name=\"modalFloatingDevice\"] input[name=\"trunkPort\"]').first();\n        $.proxy(that.toggleTaggedVlan, checkbox)(e);\n    });\n};\n\nFloatingDeviceView.prototype = (function(){\n    function F(){}\n    F.prototype = ItemView.prototype;\n    return new F();\n})();\n\nFloatingDeviceView.prototype.constructor = FloatingDeviceView;\n\nFloatingDeviceView.prototype.toggleTaggedVlan = function(e) {\n    var checkbox = $(this);\n    var taggedVlan = checkbox.closest('form').find('input[name=\"taggedVlan\"]').first();\n\n    if (checkbox.is(':checked'))\n        taggedVlan.removeAttr('disabled');\n    else\n        taggedVlan.attr('disabled', 1);\n};\n\n","$(function() { // DOM ready\n    var interfaces = new Interfaces();\n    var view = new InterfaceView({ interfaces: interfaces, parent: $('#section') });\n\n    var read = $.proxy(view.readInterface, view);\n    $('#section').on('click', '#createNetwork', read);\n});","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\n$(function() { // DOM ready\n    var items = new Provisioners();\n    var view = new ProvisionerView({ items: items, parent: $('#section') });\n});\n\n/*\n * The Provisioners class defines the operations available from the controller.\n */\nvar Provisioners = function() {\n};\n\nProvisioners.prototype = new Items();\n\nProvisioners.prototype.id  = '#provisioners';\n\nProvisioners.prototype.formName  = 'modalProvisioner';\n\nProvisioners.prototype.modalId   = '#modalProvisioner';\n\nProvisioners.prototype.createSelector = \".createProvisioner\";\n\n/*\n * The ProvisionerView class defines the DOM operations from the Web interface.\n */\n\n\nvar ProvisionerView = function(options) {\n    ItemView.call(this,options);\n    var that = this;\n    this.parent = options.parent;\n    this.items = options.items;\n    var toggleInputs = $.proxy(this.toggleInputs,this);\n    // Hide the sectype, eap_type fields when 'Open' is selected\n    options.parent.on('change', 'form[name=\"modalProvisioner\"] select[name=\"security_type\"]', toggleInputs);\n    // Hide the ca_cert_path, cert_type and company fields when 'PEAP' is selected\n    options.parent.on('change', 'form[name=\"modalProvisioner\"] select[name=\"eap_type\"]', toggleInputs);\n    // Hide passwork if dpsk is selected\n    options.parent.on('change', 'form[name=\"modalProvisioner\"] input[name=\"dpsk\"]', toggleInputs);\n    // Hide fileds on opening the provisioner\n    options.parent.on('show', '#modalProvisioner', toggleInputs);\n};\n\nProvisionerView.prototype = (function(){\n    function F(){}\n    F.prototype = ItemView.prototype;\n    return new F();\n})();\n\nProvisionerView.prototype.constructor = ProvisionerView;\n\nProvisionerView.prototype.toggleInputs = function(e) {\n    this.togglePkiProvider(e);\n    this.toggleWifiKey(e);\n    this.toggleEapType(e);\n    this.toggleServerCertificate(e);\n};\n\nProvisionerView.prototype.toggleWifiKey = function(e) {\n    var security_type = $('#security_type option:selected').text();\n    var eap_type = $('#eap_type option:selected').text();\n    var passcode_input = $('#passcode').closest('.control-group');\n    var dpsk_input = $('#dpsk').closest('.control-group');\n    var dpsk = $('input[name=\"dpsk\"]').prop('checked');\n    var psk_size = $('#psk_size').closest('.control-group');\n    if (security_type != \"Open\" && eap_type == \"No EAP\") {\n        dpsk_input.show();\n        if (dpsk) {\n            psk_size.show();\n            passcode_input.hide();\n        }\n        else {\n            psk_size.hide();\n            passcode_input.show();\n        }\n    }\n    else {\n        passcode_input.hide();\n        dpsk_input.hide();\n    }\n};\n\nProvisionerView.prototype.toggleEapType = function(e) {\n    var security_type = $('#security_type option:selected').text();\n    var eap_input = $('#eap_type').closest('.control-group');\n    if ( security_type == 'WPA2') {\n        eap_input.show();\n    }\n    else {\n        eap_input.hide();\n    }\n};\n\nProvisionerView.prototype.togglePkiProvider = function(e) {\n    var security_type = $('#security_type option:selected').text();\n    var eap_type = $('#eap_type option:selected').text();\n    var pki_input = $('#pki_provider').closest('.control-group');\n    if (security_type == \"WPA2\" && eap_type == \"EAP-TLS\") {\n        pki_input.show();\n    }\n    else {\n        pki_input.hide();\n    }\n};\n\nProvisionerView.prototype.toggleServerCertificate = function(e) {\n    var security_type = $('#security_type option:selected').text();\n    var eap_type = $('#eap_type option:selected').text();\n    var server_certificate = $('#server_certificate_path').closest('.control-group');\n    if (security_type == \"WPA2\" && eap_type == \"PEAP\") {\n        server_certificate.show();\n    }\n    else {\n        server_certificate.hide();\n    }\n};\n\n\n\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\n/* Show a Role */\n    $('#section').on('click', '[href*=\"#modalRole\"]', function(event) {\n        var modal = $('#modalRole');\n        var url = $(this).attr('href');\n        var section = $('#section');\n        var loader = section.prev('.loader');\n        loader.show();\n        section.fadeTo('fast', 0.5);\n        modal.empty();\n        $.ajax(url)\n            .always(function(){\n                loader.hide();\n                section.stop();\n                section.fadeTo('fast', 1.0);\n            })\n            .done(function(data) {\n                modal.append(data);\n                modal.one('shown', function() {\n                    $('#name').focus();\n                });\n                modal.modal({ shown: true });\n            })\n            .fail(function(jqXHR) {\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                var status_msg = getStatusMsg(jqXHR);\n                showError($('#section table'), status_msg);\n            });\n\n        return false;\n    });\n\n    /* Create a role */\n    $('#section').on('click', '#createRole', function(event) {\n        var modal = $('#modalRole');\n        var url = $(this).attr('href');\n        var section = $('#section');\n        var loader = section.prev('.loader');\n        loader.show();\n        section.fadeTo('fast', 0.5);\n        modal.empty();\n        $.ajax(url)\n            .always(function(){\n                loader.hide();\n                section.stop();\n                section.fadeTo('fast', 1.0);\n            })\n            .done(function(data) {\n                modal.append(data);\n                modal.one('shown', function() {\n                    $('#name').focus();\n                    $('.chzn-select').chosen({width: ''});\n                    $('.chzn-deselect').chosen({allow_single_deselect: true, width: ''});\n                });\n                modal.modal({ shown: true });\n            })\n            .fail(function(jqXHR) {\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                var status_msg = getStatusMsg(jqXHR);\n                showError($('#section table'), status_msg);\n            });\n\n        return false;\n    });\n\n    /* Modal Editor: save a role */\n    $('body').on('submit', 'form[name=\"role\"]', function(event) {\n        var form = $(this),\n        modal = $('#modalRole'),\n        modal_body = modal.find('.modal-body'),\n        valid = isFormValid(form);\n\n        if (valid) {\n            resetAlert(modal_body);\n            $.ajax({\n                type: 'POST',\n                url: form.attr('action'),\n                data: form.serialize()\n            }).done(function() {\n                modal.on('hidden', function() {\n                    // Refresh the section\n                    $(window).hashchange();\n                });\n                modal.modal('hide');\n            }).fail(function(jqXHR) {\n                var status_msg = getStatusMsg(jqXHR);\n                resetAlert(modal_body);\n                showPermanentError(modal_body.children().first(), status_msg);\n            });\n        }\n\n        return false;\n    });\n","$(function() { // DOM ready\n    var items = new ScanWMIRules();\n    var view = new ScanWMIRuleView({ items: items, parent: $('#section') });\n});\n\n/*\n * The ScanWMIRules class defines the operations available from the controller.\n */\nvar ScanWMIRules = function() {\n};\n\nScanWMIRules.prototype = new Items();\n\n/*\n * The ScanWMIRuleView class defines the DOM operations from the Web interface.\n */\n\nvar ScanWMIRuleView = function(options) {\n    var that = this;\n    this.parent = options.parent;\n    this.items = options.items;\n    options.parent.on('click', '#wmi_rulesEmpty [href=\"#add\"]', function(event) {\n        $('#wmi_rules').trigger('addrow');\n        $('#wmi_rulesEmpty').addClass('hidden');\n        return false;\n    });\n};\n\n","$(function() { // DOM ready\n    var items = new Sources();\n    var view = new SourceView({ items: items, parent: $('#section') });\n});\n\n/*\n * The Sources class defines the operations available from the controller.\n */\nvar Sources = function() {\n};\n\nSources.prototype = new Items();\n\nSources.prototype.id  = '#sources';\n\nSources.prototype.formName  = 'modalSource';\n\nSources.prototype.modalId   = '#modalSource';\n\n/*\n * The SourceView class defines the DOM operations from the Web interface.\n */\n\n\nvar SourceView = function(options) {\n    ItemView.call(this, options);\n    var that = this;\n    var items = options.items;\n    var id = items.id;\n    var formName = items.formName;\n    var formSelector = 'form[name=\"'+ formName + '\"]';\n    options.parent.off('click', id + ' [href$=\"/clone\"]');\n    options.parent.off('click', id + ' [href$=\"/delete\"]');\n    options.parent.on('click' , '#testSourceBtn', $.proxy(this.testSource, this));\n    options.parent.on('change', formSelector + ' select[name*=\"\\\\.conditions\\\\.\"][name$=\".attribute\"]', $.proxy(this.changeCondition, this));\n    options.parent.on('change', formSelector + ' select[name*=\"\\\\.actions\\\\.\"][name$=\".type\"]', $.proxy(this.changeAction, this));\n    options.parent.on('section.loaded', $.proxy(this.loadSource, this));\n    options.parent.on('dynamic-list.add', 'div[id^=\"accordion\\\\.group\\\\.administration_rules\\\\.\"]', $.proxy(this.addRule, this));\n    options.parent.on('dynamic-list.add', 'div[id^=\"accordion\\\\.group\\\\.authentication_rules\\\\.\"]', $.proxy(this.addRule, this));\n\n    options.parent.on('dynamic-list.add', 'div[id*=\"\\\\.actions\\\\.\"]', $.proxy(this.addAction, this));\n    options.parent.on('dynamic-list.add', 'div[id*=\"\\\\.conditions\\\\.\"]', $.proxy(this.addCondition, this));\n    options.parent.on('dynamic-list.ordered', id + ' #internal-sources tbody', $.proxy(this.sortItems, this));\n};\n\nSourceView.prototype = (function(){\n    function F(){}\n    F.prototype = ItemView.prototype;\n    return new F();\n})();\n\nSourceView.prototype.addCondition = function(e) {\n    e.stopPropagation();\n    var condition = $(e.target);\n    updateSoureRuleCondition(condition.find('select[name*=\"\\\\.conditions\\\\.\"][name$=\".attribute\"]'), true);\n    return false;\n};\n\nSourceView.prototype.addAction = function(e) {\n    e.stopPropagation();\n    var action = $(e.target);\n    updateAction(action.find('select[name*=\"\\\\.actions\\\\.\"][name$=\".type\"]'), true);\n    return false;\n};\n\nSourceView.prototype.addRule = function(e) {\n    var rule = $(e.target);\n    rule.find('select[name*=\"\\\\.actions\\\\.\"][name$=\".type\"]:not(.disabled)').each(function() {\n        updateAction($(this), true);\n    });\n};\n\nSourceView.prototype.loadSource = function(e) {\n    var formName = this.items.formName;\n    $('#action_templates').find('option').removeAttr('id');\n    $('form[name=\"'+ formName + '\"] select[name*=\"\\\\.conditions\\\\.\"][name$=\".attribute\"]:not(.disabled)').each(function() {\n        updateSoureRuleCondition($(this), true);\n    });\n    $('form[name=\"'+ formName + '\"] select[name*=\"\\\\.actions\\\\.\"][name$=\".type\"]:not(.disabled)').each(function() {\n        updateAction($(this), true);\n    });\n};\n\nSourceView.prototype.changeAction = function(e) {\n    updateAction($(e.target), false);\n};\n\nSourceView.prototype.changeCondition = function(e) {\n    updateSoureRuleCondition($(e.target), false);\n};\n\nSourceView.prototype.testSource = function(e) {\n    e.preventDefault();\n    resetAlert($('#section'));\n    var btn = $(e.target);\n    var form = btn.closest('form');\n    var valid = isFormValid(form);\n    var alertSibling = btn.closest('.input-append');\n    if (valid) {\n        this.items.post({\n            url: btn.attr('href'),\n            data: form.serialize(),\n            always: function() {\n                btn.button('reset');\n            },\n            success: function(data, textStatus, jqXHR) {\n                showSuccess(alertSibling, data.status_msg);\n            },\n            errorSibling: btn.closest(alertSibling)\n        });\n    } else {\n        showError(alertSibling, \"Required field missing\");\n    }\n};\n\nSourceView.prototype.sortItems = function(e) {\n    var form = $(e.target).closest('form');\n    this.items.post({\n        url: form.attr('action'),\n        data: form.serialize(),\n        success: function(data, textStatus, jqXHR) {\n            showSuccess(form, data.status_msg);\n        },\n        errorSibling: form\n    });\n};\n\nSourceView.prototype.updateItem = function(e) {\n    e.preventDefault();\n\n    var that = this;\n    var form = $(e.target);\n    var btn = form.find('.btn-primary');\n    var valid = isFormValid(form);\n    if (valid) {\n        btn.button('loading');\n        resetAlert($('#section'));\n        this.items.post({\n            url: form.attr('action'),\n            data: form.serialize(),\n            always: function() {\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                btn.button('reset');\n            },\n            success: function(data, textStatus, jqXHR) {\n                var redirect = jqXHR.getResponseHeader('Location');\n                if (redirect) {\n                    location.hash = jqXHR.getResponseHeader('Location');\n                }\n                else {\n                    showSuccess(form, data.status_msg);\n                }\n            },\n            errorSibling: form\n        });\n    }\n};\n\nSourceView.prototype.constructor = SourceView;\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\n$(function() { // DOM ready\n    var switches = new Switches();\n    var view = new SwitchView({ switches: switches, parent: $('#section') });\n});\n\n/*\n * The Switches class defines the operations available from the controller.\n */\nvar Switches = function() {\n};\n\nSwitches.prototype.get = function(options) {\n    $.ajax({\n        url: options.url\n    })\n        .always(options.always)\n        .done(options.success)\n        .fail(function(jqXHR) {\n            var status_msg = getStatusMsg(jqXHR);\n            showPermanentError(options.errorSibling, status_msg);\n        });\n};\n\nSwitches.prototype.post = function(options) {\n    $.ajax({\n        url: options.url,\n        type: 'POST',\n        data: options.data\n    })\n        .always(options.always)\n        .done(options.success)\n        .fail(function(jqXHR) {\n            var status_msg = getStatusMsg(jqXHR);\n            showPermanentError(options.errorSibling, status_msg);\n        });\n};\n\n/*\n * The SwitchView class defines the DOM operations from the Web interface.\n */\nvar SwitchView = function(options) {\n    var that = this;\n    this.parent = options.parent;\n    this.switches = options.switches;\n    this.disableToggle = false;\n\n    // Display the switch in a modal\n    var read = $.proxy(this.readSwitch, this);\n    options.parent.on('click', '#switches [href$=\"/read\"], #switches [href$=\"/clone\"], .createSwitch', read);\n\n    // Close modal on import from csv\n    var import_csv = $.proxy(this.importSwitch, this);\n    options.parent.on('submit', 'form[name=\"modalSwitchImport\"]', import_csv);\n\n    // Save the modifications from the modal\n    var update = $.proxy(this.updateSwitch, this);\n    options.parent.on('submit', 'form[name=\"modalSwitch\"]', update);\n\n    // Delete the switch\n    var delete_s = $.proxy(this.deleteConfirm, this);\n    options.parent.on('click', '#switches [href$=\"/delete\"]', delete_s);\n\n    // Remove the group from the switch\n    var remove_group = $.proxy(this.removeGroup, this);\n    options.parent.on('click', 'form[name=\"modalSwitch\"] [href$=\"/remove_group\"]', remove_group);\n\n    // Add a group to the switch group\n    var add_to_group = $.proxy(this.addToGroup, this);\n    options.parent.on('click', 'form[name=\"modalSwitch\"] #addNewMember', add_to_group);\n\n    // Disable the uplinks field when 'dynamic uplinks' is checked\n    options.parent.on('change', 'form[name=\"modalSwitch\"] input[name=\"uplink_dynamic\"]', this.changeDynamicUplinks);\n\n    // Disable the mapping fields for inactive modes (VLAN and/or roles)\n    options.parent.on('change', 'form[name=\"modalSwitch\"] input[type=\"checkbox\"][name*=\"Map\"]', this.changeRoleMapping);\n\n    // Initial creation of an inline trigger when no trigger is defined\n    options.parent.on('click', '#inlineTriggerEmpty [href=\"#add\"]', this.addInlineTrigger);\n\n    // Initialize the inline trigger fields when displaying a switch\n    options.parent.on('show', '#modalSwitch', function(e) {\n        $('#inlineTrigger tr:not(.hidden) select').each(function() {\n            that.updateInlineTrigger($(this));\n        });\n\n        options.parent.find('#newMember[data-provide=\"typeahead\"]').typeahead({\n            source: $.proxy(that.searchSwitch, that),\n            minLength: 2,\n            items: 11,\n            matcher: function(item) { return true; }\n        });\n    });\n\n    // Update the trigger fields when adding a new trigger\n    options.parent.on('admin.added', '#inlineTrigger tr', function(e) {\n        var attribute = $(this).find('select').first();\n        that.updateInlineTrigger(attribute);\n    });\n\n    // Update the trigger fields when changing a trigger\n    options.parent.on('change', '#inlineTrigger select', function(e) {\n        that.updateInlineTrigger($(this));\n    });\n\n    // pagination the switch\n    var pagination = $.proxy(this.pagination, this);\n    options.parent.on('click', '#switches [href*=\"/list\"]', pagination);\n\n    // submit search\n    options.parent.on('submit', '#switches #search', $.proxy(this.submitSearch, this));\n\n    // reset search\n    options.parent.on('reset', '#switches #search', $.proxy(this.resetSearch, this));\n\n    // pagination search\n    options.parent.on('click', '#switches [href*=\"/switch/search\"]', $.proxy(this.searchPagination, this));\n\n    // invalidate cache\n    options.parent.on('click', '#invalidate_cache', $.proxy(this.invalidateCache, this));\n};\n\nSwitchView.prototype.readSwitch = function(e) {\n    e.preventDefault();\n\n    var that = this;\n    var modal = $('#modalSwitch');\n    var section = $('#section');\n    var loader = section.prev('.loader');\n    loader.show();\n    section.fadeTo('fast', 0.5);\n    modal.empty();\n    $('.chzn-drop').remove(); // fixes a chzn bug with optgroups\n    this.switches.get({\n        url: $(e.target).attr('href'),\n        always: function() {\n            loader.hide();\n            section.stop();\n            section.fadeTo('fast', 1.0);\n        },\n        success: function(data) {\n            modal.append(data);\n            modal.find('.chzn-select').chosen({width: ''});\n            modal.find('.chzn-deselect').chosen({allow_single_deselect: true, width: ''});\n            modal.one('shown', function() {\n                var checkbox;\n                modal.find(':input:visible').first().focus();\n                // Update state of uplinks field\n                checkbox = $('form[name=\"modalSwitch\"] input[name=\"uplink_dynamic\"]');\n                that.changeDynamicUplinks.call(checkbox);\n                // Update state of mapping fields\n                checkbox = $('form[name=\"modalSwitch\"] input[type=\"checkbox\"][name*=\"Map\"]');\n                checkbox.each(function(i) { that.changeRoleMapping.call(this); });\n            });\n            modal.modal({ shown: true });\n        },\n        errorSibling: section.find('h2').first()\n    });\n};\n\nSwitchView.prototype.changeRoleMapping = function(e) {\n    var checkbox = $(this);\n    var match = /(.+)Map/.exec(checkbox.attr('name'));\n    var type = match[1];\n    var inputs = $.merge(checkbox.closest('form').find('input[type=\"text\"][name*=\"'+type+'\"]'), checkbox.closest('form').find('textarea[name*=\"'+type+'\"]'));\n\n    if (checkbox.is(':checked'))\n        inputs.removeAttr('disabled');\n    else\n        inputs.attr('disabled', 1);\n};\n\nSwitchView.prototype.changeDynamicUplinks = function(e) {\n    var checkbox = $(this);\n    var uplinks = checkbox.closest('form').find('input[name=\"uplink\"]').first();\n\n    if (checkbox.is(':checked'))\n        uplinks.attr('disabled', 1);\n    else\n        uplinks.removeAttr('disabled');\n};\n\nSwitchView.prototype.addInlineTrigger = function(e) {\n    var tbody = $('#inlineTrigger').children('tbody');\n    var row_model = tbody.children('.hidden').first();\n    if (row_model) {\n        $('#inlineTriggerEmpty').addClass('hidden');\n        var row_new = row_model.clone();\n        row_new.removeClass('hidden');\n        row_new.insertBefore(row_model);\n        row_new.trigger('admin.added');\n    }\n    return false;\n};\n\nSwitchView.prototype.updateInlineTrigger = function(attribute) {\n    var trigger = attribute.find(':selected').val();\n    var value = attribute.next();\n\n    if (trigger != value.attr('data-trigger')) {\n        value.attr('disabled', 1);\n\n        var value_new = $('#' + trigger + '_trigger').clone();\n        value_new.attr('id', value.attr('id'));\n        value_new.attr('name', value.attr('name'));\n        value_new.insertBefore(value);\n\n        if (!value.attr('data-trigger')) {\n            // Preserve values of an existing condition\n            value_new.val(value.val());\n        }\n\n        // Remove previous fields\n        value.remove();\n\n        // Remember the data type\n        value_new.attr('data-trigger', trigger);\n    }\n};\n\nSwitchView.prototype.updateSwitch = function(e) {\n    e.preventDefault();\n\n    var that = this;\n    var form = $(e.target);\n    var btn = form.find('.btn-primary');\n    var modal = form.closest('.modal');\n    var valid = isFormValid(form);\n    if (valid) {\n        var modal_body = modal.find('.modal-body').first();\n        resetAlert(modal_body);\n        btn.button('loading');\n        form.find('tr.hidden :input').attr('disabled', 'disabled');\n        this.switches.post({\n            url: form.attr('action'),\n            data: form.serialize(),\n            always: function() {\n                // Restore hidden/template rows\n                form.find('tr.hidden :input').removeAttr('disabled');\n                btn.button('reset');\n            },\n            success: function(data) {\n                modal.modal('toggle');\n                showSuccess(that.parent.find('.table.items').first(), data.status_msg);\n                that.refreshTable();\n            },\n            errorSibling: modal_body.children().first()\n        });\n    }\n};\n\nSwitchView.prototype.importSwitch = function(e) {\n    var that = this;\n    var form = $(e.target);\n    var iform = $(\"#iframe_form\");\n    var btn = form.find('.btn-primary');\n    var modal = form.closest('.modal');\n    btn.button('loading');\n    iform.one('load', function(event) {\n            btn.button('reset');\n            var body = $(this).contents().find('body');\n            var text = body.find('textarea').val();\n            modal.modal('hide');\n            showPermanentSuccess($('#switches'), text);\n    });\n\n};\n\nSwitchView.prototype.addToGroup = function(e) {\n    e.preventDefault();\n\n    var that = this;\n    var button = $(e.target);\n    var newMemberId = $('#newMember').val();\n    this.switches.get({\n        url: \"/config/switch/\"+newMemberId+\"/add_to_group/\"+button.attr('data-group'),\n        success: function(data) {\n            that.readSwitch({\n              preventDefault: function(){},\n              target: {\n                href: \"/config/switchgroup/\"+button.attr('data-group')+\"/read?tab=switchGroupMembers\",\n              },\n            });\n            showSuccess($('#modalSwitch .modal-body').children().first(), data.status_msg);\n        },\n        errorSibling: $('#modalSwitch .modal-body').children().first()\n    });\n};\n\nSwitchView.prototype.removeGroup = function(e) {\n    e.preventDefault();\n\n    var that = this;\n    var a = $(e.target);\n    this.switches.get({\n        url: a.attr('href'),\n        success: function(data) {\n            a.closest('.switchGroupMember').remove();\n            if ($('.switchGroupMember').size() === 0) {\n              $('#switchMembersEmpty').closest('tr').removeClass('hidden');\n            }\n            showSuccess($('#modalSwitch .modal-body').children().first(), data.status_msg);\n        },\n        errorSibling: $('#modalSwitch .modal-body').children().first(),\n    });\n};\n\nSwitchView.prototype.list = function() {\n    this.switches.get({\n        url: '/config/switch/list',\n        success: function(data) {\n            var table = $('#switches');\n            table.html(data);\n        },\n        errorSibling: $('#switches')\n    });\n};\n\n\nSwitchView.prototype.refreshPage = function() {\n    var that = this;\n    var pagination = $('.pagination').first();\n    var formId = pagination.attr('data-from-form') || '#search';\n    var form = $(formId);\n    var link = pagination.find('li.disabled a[href]').first();\n    if (form.length === 0) {\n        form = $('#search');\n    }\n    var columns = $('#columns');\n    var href = link.attr(\"href\");\n    var section = $('#section');\n    var status_container = $(\"#section\").find('h2').first();\n    var loader = section.prev('.loader');\n    loader.show();\n    section.fadeTo('fast', 0.5);\n    section.fadeTo('fast', 0.5, function() {\n        that.switches.post({\n            url: href,\n            data: form.serialize() + \"&\" + columns.serialize(),\n            always: function() {\n                loader.hide();\n                section.fadeTo('fast', 1.0);\n            },\n            success: function(data) {\n                section.html(data);\n            },\n            errorSibling: status_container\n        });\n    });\n    return false;\n};\n\nSwitchView.prototype.refreshTable = function() {\n    var that = this;\n    var pagination = $('.pagination').first();\n    var formId = pagination.attr('data-from-form') || '#search';\n    var form = $(formId);\n    var link = pagination.find('li.disabled a[href]').first();\n    if(form.length === 0) {\n        form = $('#search');\n    }\n    var columns = $('#columns');\n    var href = link.attr(\"href\");\n    var section = $('#section');\n    var status_container = $(\"#section\").find('h2').first();\n    var table = $('#switches');\n    var loader = section.prev('.loader');\n    loader.show();\n    section.fadeTo('fast', 0.5, function() {\n        that.switches.post({\n            url: href,\n            data: form.serialize() + \"&\" + columns.serialize(),\n            always: function() {\n                loader.hide();\n                section.fadeTo('fast', 1.0);\n            },\n            success: function(data) {\n                table.html(data);\n            },\n            errorSibling: status_container\n        });\n    });\n    return false;\n};\nSwitchView.prototype.pagination = function(e) {\n    e.preventDefault();\n    var link = $(e.target);\n    var url = link.attr('href');\n    var section = $('#section');\n    var loader = section.prev('.loader');\n    loader.show();\n    section.fadeTo('fast', 0.5);\n    this.switches.get({\n        url: url,\n        always: function() {\n            loader.hide();\n            section.stop();\n            section.fadeTo('fast', 1.0);\n        },\n        success: function(data) {\n            var table = $('#switches');\n            table.html(data);\n        },\n        errorSibling: $('#switches')\n    });\n    return false;\n};\n\nSwitchView.prototype.searchPagination = function(e) {\n    e.preventDefault();\n    var link = $(e.currentTarget);\n    var form = $('#search');\n    var href = link.attr(\"href\");\n    this.refreshListFromForm(href,form);\n    return false;\n};\n\nSwitchView.prototype.refreshListFromForm = function(href,form) {\n    var that = this;\n    var section = $('#section');\n    $(\"body,html\").animate({scrollTop:0}, 'fast');\n    var status_container = $(\"#section\").find('h2').first();\n    var loader = section.prev('.loader');\n    loader.show();\n    section.fadeTo('fast', 0.5, function() {\n        that.switches.post({\n            url: href,\n            data: form.serialize(),\n            always: function() {\n                loader.hide();\n                section.fadeTo('fast', 1.0);\n            },\n            success: function(data) {\n                var table = $('#switches');\n                table.html(data);\n            },\n            errorSibling: status_container\n        });\n    });\n    return false;\n};\n\nSwitchView.prototype.submitSearch = function(e) {\n    e.preventDefault();\n    var that = this;\n    var form = $(e.currentTarget);\n    var href = form.attr(\"action\");\n    this.refreshListFromForm(href,form);\n    return false;\n};\n\nSwitchView.prototype.resetSearch = function(e) {\n    var that = this;\n    var section = $('#section');\n    $(\"body,html\").animate({scrollTop:0}, 'fast');\n    var status_container = $(\"#section\").find('h2').first();\n    var loader = section.prev('.loader');\n    loader.show();\n    section.fadeTo('fast', 0.5, function() {\n        that.switches.post({\n            url: '/config/switch/list',\n            always: function() {\n                loader.hide();\n                section.fadeTo('fast', 1.0);\n            },\n            success: function(data) {\n                var table = $('#switches');\n                table.html(data);\n            },\n            errorSibling: status_container\n        });\n    });\n    return true;\n};\n\nSwitchView.prototype.deleteConfirm = function(e) {\n    e.preventDefault();\n    var that = this;\n\n    var btn = $(e.target);\n    var row = btn.closest('tr');\n    var url = btn.attr('href');\n    var modal = $('#deleteSwitch');\n    var confirm_link = modal.find('a.btn-primary').first();\n    confirm_link.off('click');\n    confirm_link.click(function() {\n        that.switches.get({\n            url: url,\n            success: function(data) {\n                showSuccess($('#switches'), data.status_msg);\n                row.fadeOut('slow', function() { $(this).remove(); });\n            },\n            always : function() {\n                modal.modal('hide');\n            },\n            errorSibling: $('#switches')\n        });\n        return false;\n    });\n    modal.modal({ show: true });\n    return false;\n};\n\nSwitchView.prototype.invalidateCache = function(e) {\n    e.preventDefault();\n\n    var modal = $('#modalSwitch');\n    var modal_body = modal.find('.modal-body');\n    var link = $(e.target);\n    var url = link.attr('href');\n    this.switches.get({\n        url: url,\n        success: function(data) {\n            showSuccess(modal_body.children().first(), data.status_msg);\n        },\n        errorSibling: modal_body.children().first()\n    });\n};\n\nSwitchView.prototype.searchSwitch = function(query, process){\n    this.switches.post({\n        url: '/config/switch/search',\n        data: {\n            'json': 1,\n            'all_or_any': 'any',\n            'searches.0.name': 'id',\n            'searches.0.op': 'like',\n            'searches.0.value': query,\n        },\n        success: function(data) {\n            var results = $.map(data.items, function(i) {\n                return i.id;\n            });\n            var input = $('#modalSwitch #newMember');\n            var control = input.closest('.control-group');\n            if (results.length === 0)\n                control.addClass('error');\n            else\n                control.removeClass('error');\n            process(results);\n        }\n    });\n};\n","$(function(){\n    $('#section').on('change', '#modalItem.syslogforwarded #all_logs', function(e) {\n        var c = e.currentTarget;\n        var logs_input = $('#logs');\n        var control_group = logs_input.closest('div.control-group');\n        if (c.checked) {\n            console.log(\"checked\");\n            control_group.addClass(\"hidden\");\n        } else {\n            control_group.removeClass(\"hidden\");\n        }\n    });\n});\n","/* -*- Mode: js; indent-tabs-mode: nil; js-indent-level: 4 -*- */\n\n$(function() { // DOM ready\n\n    /* Show a violation from the received HTML */\n    function showViolation(data) {\n        var modal = $('#modalViolation');\n        modal.empty();\n        modal.append(data);\n        modal.find('.switch').bootstrapSwitch();\n        modal.find('.chzn-select').chosen({inherit_select_classes: true, width: ''});\n        modal.find('.chzn-deselect').chosen({allow_single_deselect: true, width: ''});\n        modal.one('shown', function() {\n            var data = modal.find('.event_triggers').first()[0];\n            violationsView.event_triggers = JSON.parse(data.textContent || data.innerHTML);\n            $('#actions').trigger('change');\n        });\n        $('.trigger option').each(function(elem){\n          var jthis = $(this);\n          var infos = jthis.val().split('::');\n          if(infos[0].toLowerCase() == \"accounting\") {\n            var new_value = violationsView.prettify_accounting(infos[0], infos[1]);\n            jthis.html(new_value);\n            jthis.closest('select').trigger(\"chosen:updated\");\n          }\n        });\n        modal.modal('show');\n    }\n\n    /* Show a violation */\n    $('#section').on('click', '[href*=\"#modalViolation\"]', function(event) {\n        var url = $(this).attr('href');\n        var section = $('#section');\n        var loader = section.prev('.loader');\n        loader.show();\n        section.fadeTo('fast', 0.5);\n        $.ajax(url)\n            .always(function(){\n                loader.hide();\n                section.stop();\n                section.fadeTo('fast', 1.0);\n            })\n            .done(function(data) {\n                showViolation(data);\n            })\n            .fail(function(jqXHR) {\n                var status_msg = getStatusMsg(jqXHR);\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                showError($('#section h2'), status_msg);\n            });\n\n        return false;\n    });\n\n    /* Create a violation */\n    $('#section').on('click', '#createViolation', function(event) {\n        var url = $(this).attr('href');\n        var section = $('#section');\n        var loader = section.prev('.loader');\n        loader.show();\n        section.fadeTo('fast', 0.5);\n        $.ajax(url)\n            .always(function(){\n                loader.hide();\n                section.stop();\n                section.fadeTo('fast', 1.0);\n            })\n            .done(function(data) {\n                showViolation(data);\n            })\n            .fail(function(jqXHR) {\n                $(\"body,html\").animate({scrollTop:0}, 'fast');\n                var status_msg = getStatusMsg(jqXHR);\n                showError($('#section h2'), status_msg);\n            });\n\n        return false;\n    });\n\n    $('#section').on('change', '#viewTriggers select', function(){\n      violationsView.recompute_triggers();\n    });\n\n    /* Delete a violation */\n    $('#section').on('click', '[href*=\"/delete\"]', function(e) {\n        e.preventDefault();\n        if ($(this).hasClass('disabled'))\n            return false;\n        var link = $(this);\n        var url = link.attr('href');\n        var row = link.closest('tr');\n        var cells = row.find('td');\n        var name = $(cells[1]).text();\n        if (!name) name = $(cells[0]).text();\n        var modal = $('#deleteViolation');\n        var confirm_link = modal.find('a.btn-primary').first();\n        modal.find('h3 span').html(name);\n        modal.modal('show');\n        confirm_link.off('click');\n        confirm_link.click(function(e) {\n            e.preventDefault();\n            confirm_link.button('loading');\n            $.ajax(url)\n                .always(function() {\n                    modal.modal('hide');\n                    confirm_link.button('reset');\n                })\n                .done(function(data) {\n                    row.remove();\n                    var table = $('#section table');\n                    if (table.find('tbody tr').length === 0) {\n                        // No more violations\n                        table.remove();\n                        $('#noViolation').removeClass('hidden');\n                    }\n                })\n                .fail(function(jqXHR) {\n                    var status_msg = getStatusMsg(jqXHR);\n                    showError($('#section h2'), status_msg);\n                    confirm_link.button('reset');\n                });\n        });\n\n        return false;\n    });\n\n    /* Modal Editor: add/remove an action */\n    $('body').on('change', '#actions', function(event) {\n        var actions = $(this).val();\n\n        // Show/hide the vclose field if 'close' is add/remove\n        var vclose_group = $('#vclose').closest('.control-group');\n        if ($.inArray('close', actions) < 0)\n            vclose_group.fadeOut('fast');\n        else\n            vclose_group.fadeIn('fast');\n\n        // Show/hide the target_category field if 'role' is add/remove\n        var role_group = $('#target_category').closest('.control-group');\n        if ($.inArray('role', actions) < 0)\n            role_group.fadeOut('fast');\n        else\n            role_group.fadeIn('fast');\n\n        // Show/hide the external_command field if 'external' is add/remove\n        var command_group = $('#external_command').closest('.control-group');\n        if ($.inArray('external', actions) < 0)\n            command_group.fadeOut('fast');\n        else\n            command_group.fadeIn('fast');\n\n        // Show/hide the user_mail_message field if 'email_user' is add/remove\n        command_group = $('#user_mail_message').closest('.control-group');\n        if ($.inArray('email_user', actions) < 0)\n            command_group.fadeOut('fast');\n        else\n            command_group.fadeIn('fast');\n\n        // Show/hide the user_mail_message field if 'email_user' is add/remove\n        command_group = $('#access_duration').closest('.control-group');\n        if ($.inArray('autoreg', actions) < 0)\n            command_group.fadeOut('fast');\n        else\n            command_group.fadeIn('fast');\n\n    });\n\n    $('body').on('switch-change', '#violations .switch', function(event, value) {\n        event.preventDefault();\n        var t = $(event.target);\n        if (t.attr('processing')) {\n            return;\n        }\n        t.attr('processing','processing');\n        var href = t.attr('data-href');\n        var toggle = value.value ? 'yes' : 'no';\n        href = href.replace(/enabled$/, toggle);\n        $.ajax({\n            type: 'POST',\n            url: href,\n            data: ''\n        }).always(function() {\n            t.attr('processing', null);\n        }).done(function(data) {\n            showSuccess($('#section h2'), data.status_msg);\n        }).fail(function(jqXHR) {\n            var status_msg = getStatusMsg(jqXHR);\n            showError($('#section h2'), status_msg);\n        });\n    });\n\n\n    /* Modal Editor: save a violation */\n    $('body').on('submit', 'form[name=\"violation\"]', function(event) {\n        var form = $(this),\n        btn = form.find('.btn-primary'),\n        modal = $('#modalViolation'),\n        modal_body = modal.find('.modal-body'),\n        valid = isFormValid(form);\n\n        if (valid) {\n            resetAlert(modal_body);\n            btn.button('loading');\n            $.ajax({\n                type: 'POST',\n                url: form.attr('action'),\n                data: form.serialize()\n            }).always(function() {\n                btn.button('reset');\n            }).done(function() {\n                modal.on('hidden', function() {\n                    // Refresh the section\n                    $(window).hashchange();\n                });\n                modal.modal('hide');\n            }).fail(function(jqXHR) {\n                var status_msg = getStatusMsg(jqXHR);\n                resetAlert(modal_body);\n                showPermanentError(modal_body.children().first(), status_msg);\n            });\n        }\n\n        return false;\n    });\n\n    $.fn.typeahead.Constructor.prototype.select = function () {\n      var val = this.$menu.find('.active').data('item');\n      this.$element\n        .val(this.updater(val))\n        .change();\n      return this.hide();\n    };\n\n    $.fn.typeahead.Constructor.prototype.render = function (items) {\n      var that = this;\n\n      items = $(items).map(function (i, item) {\n        i = $(that.options.item).data('item', item);\n        i.find('a').html(that.highlighter(item));\n        return i[0];\n      });\n\n      items.first().addClass('active');\n      this.$menu.html(items);\n      return this;\n    };\n\n    /* Modal Editor: remove a trigger */\n    $('body').on('click', '[href=\"#deleteTrigger\"]', function(event) {\n        event.preventDefault();\n        var jthis = $(event.target);\n        jthis.closest('.control-group').remove();\n        if(!$('#viewTriggers').find('select').length){\n          $('#noTrigger').removeClass('hide');\n        }\n        violationsView.recompute_triggers();\n        return false;\n    });\n\n    /* Modal Editor: add a combined trigger */\n    $('body').on('click', '[href=\"#addTrigger\"]', function(event) {\n        event.preventDefault();\n        var jthis = $(event.target);\n        $('#viewTriggers').slideUp(function(){\n          $('#editedTrigger').html(ViolationsView.add_combined_trigger_form());\n          violationsView.previous_trigger_options = $('#editedTrigger .triggerButtons').html();\n          $('#editedTrigger .triggerButtons').html('<a href=\"#backEditTrigger\" class=\"pull-left btn btn-default\"><i class=\"icon  icon-chevron-left\"></i></a>');\n          $('#editedTrigger .chzn-select').chosen({inherit_select_classes: true, width: ''});\n          $('#editTrigger').slideDown();\n        });\n        \n        return false;\n    });\n\n    /* Modal Editor: edit a trigger */\n    $('body').on('click', '[href=\"#editTrigger\"]', function(event) {\n        event.preventDefault();\n        var jthis = $(event.target);\n        $('#viewTriggers').slideUp(function(){\n          var triggers = jthis.closest('.control-group');\n          triggers.appendTo('#editedTrigger');\n          violationsView.previous_trigger_options = $('#editedTrigger .triggerButtons').html();\n          $('#editedTrigger .triggerButtons').html('<a href=\"#backEditTrigger\" class=\"pull-left btn btn-default\"><i class=\"icon  icon-chevron-left\"></i></a>');\n          $('#editTrigger').slideDown();\n        });\n        \n        return false;\n    });\n\n    /* Modal Editor: back from edit a trigger */\n    $('body').on('click', '[href=\"#backEditTrigger\"]', function(event) {\n        event.preventDefault();\n        var jthis = $(event.target);\n        $('#editTrigger').slideUp(function(){\n          var triggers = jthis.closest('.control-group');\n          if(triggers.find(\"select option:selected\").length){\n            $('#noTrigger').addClass('hide');\n            triggers.find('.triggerButtons').html(violationsView.previous_trigger_options);\n            triggers.appendTo('#viewTriggers');\n          }\n          $('#editedTrigger').html('');\n          $('#viewTriggers').slideDown();\n        });\n        \n        violationsView.recompute_triggers();\n        return false;\n    });\n\n    /* Modal Editor: add a trigger to a combined trigger */\n    $('body').on('click', '#add_trigger_part', function(event) {\n        event.preventDefault();\n        var tid =  $('#tid');\n        var id = tid.val();\n        var type_select = $('#trigger_type').find(':selected');\n        var type = type_select.val();\n\n        if(type === '') return false;\n  \n        var type_name = type_select.text();\n        var value = type + \"::\" + id;\n        var value_pretty = type_name + \" : \" + id;\n        violationsView.append_trigger(value, value_pretty);\n    });\n\n    $('body').on('click', '.add_accounting_trigger', function(event){\n      event.preventDefault();\n      var trigger_direction = $('#accounting_widget_direction').find(':selected').val();    \n      var trigger_amount = $('#accounting_widget_amount').val();    \n      var trigger_unit = $('#accounting_widget_unit').find(':selected').val();    \n      var trigger_window = $('#accounting_widget_window').find(':selected').val();    \n      var tid = trigger_direction+trigger_amount+trigger_unit+trigger_window;\n      var trigger = \"accounting::\"+tid;\n      violationsView.append_trigger(trigger, violationsView.prettify_accounting(\"accounting\",tid));\n    });\n\n    /* Modal Editor: add a trigger to a combined trigger from a widget */\n    $('body').on('click', '.add_trigger_part', function(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        var tid =  $(this).closest('.controls').find('select').find(':selected');\n        var id = tid.val();\n        var type_select = $('#trigger_type').find(':selected');\n        var type = type_select.val();\n        var type_name = type_select.html();\n        var value = type + \"::\" + id;\n        var value_pretty = type_name + \" : \" + tid.html();\n        violationsView.append_trigger(value, value_pretty);\n    });\n\n    \n    $('body').on('click', '#violationSubmit', function(event) {\n        event.preventDefault();\n        $('#editTrigger .control-group select').not('#trigger_type').not('.trigger_widget_select').appendTo('#viewTriggers');\n        violationsView.recompute_triggers();\n        $('[name=\"violation\"]').submit();\n        return false;\n    });\n\n    $('body').on('change', '#trigger_type', function(){\n        var type = $('#trigger_type option:selected').val();\n        $('.trigger_widget').slideUp();\n        $('.'+type+'_triggers').slideDown();\n    });\n\n    $('body').on('click', '.trigger_widget a', function(){\n        var modal = $('#modalViolation');\n        modal.modal('hide');\n        window.location = $(this).attr('href'); \n    });\n\n\n});\n\nvar ViolationsView = function(){};\n\nViolationsView.prototype.recompute_triggers = function() {\n  var grouped = {};\n  $('#viewTriggers select').find(':selected').each(function(){\n      var option = $(this);\n      var select = option.closest('select');\n      select.uniqueId();\n      if(!grouped[select.attr('id')]){\n        grouped[select.attr('id')] = [];\n      }\n      grouped[select.attr('id')].push(option.val());\n  });\n\n  var triggers = [];\n  for(var key in grouped){\n    var trigger;\n    if(grouped[key].length > 1){\n      trigger = grouped[key].join('&');\n      trigger = \"(\"+trigger+\")\";\n    }\n    else {\n      trigger = grouped[key][0];\n    }\n    triggers.push(trigger);\n  }\n\n  $('#trigger').val(triggers.join());\n\n};\n\nViolationsView.add_combined_trigger_form = function(){\n  var form = [\n  '<div class=\"control-group\">',\n  '  <span class=\"triggerButtons\">',\n  '    <a class=\"btn pull-left\" href=\"#editTrigger\">',\n  '      <i class=\"icon icon-pencil\"></i>',\n  '    </a>',\n  '    <a class=\"btn btn-danger pull-left\" href=\"#deleteTrigger\">',\n  '      <i class=\"icon icon-remove\"></i>',\n  '    </a>',\n  '  </span>',\n  '  <select multiple=\"multiple\" class=\"chzn-select input-xxlarge\">',\n  '  </select>',\n  '</div>'];\n\n  return form.join(' ');\n};\n\nViolationsView.prototype.prettify_accounting = function(type, value) {\n  var lc_type = type.toLowerCase();\n  var lc_value = value.toLowerCase();\n  var lc_trigger = lc_type+\"::\"+lc_value;\n  var pretty;\n  if(lc_value == \"bandwidthexpired\") pretty = \"Bandwidth expired\";\n  else if(lc_value == \"timeexpired\") pretty = \"Time expired\";\n  else {\n    var rx = /^(TOT|IN|OUT)([0-9]+)(B|KB|MB|GB|TB)([DWMY])$/;\n    var results = rx.exec(value);\n    var direction = results[1];\n    var amount = results[2];\n    var unit = results[3];\n    var timeframe = results[4];\n    pretty = \"\";\n\n    if(direction == \"TOT\") pretty += \"Total traffic over \"+amount+\" \"+unit+\" \";\n    else if(direction == \"IN\") pretty += \"Inbound traffic over \"+amount+\" \"+unit+\" \";\n    else if(direction == \"OUT\") pretty += \"Outbound traffic over \"+amount+\" \"+unit+\" \";\n\n    if(timeframe == \"D\") pretty += \"per day\";\n    else if(timeframe == \"W\") pretty += \"per week\";\n    else if(timeframe == \"M\") pretty += \"per month\";\n    else if(timeframe == \"Y\") pretty += \"per year\";\n  }\n  return pretty;\n};\n\nViolationsView.prototype.append_trigger = function(value,value_pretty){\n  var that = this;\n  if(!value_pretty) value_pretty = value;\n\n  var error = false;\n  var select = $('#editedTrigger select').first();\n  if(that.event_triggers.indexOf(value.split('::')[0].toLowerCase()) > -1){\n    select.find('option:selected').each(function(){\n      var data = $(this).val().split('::');\n      if(that.event_triggers.indexOf(data[0].toLowerCase()) > -1){\n          error = $(this).html();\n      }\n    });\n  }\n\n  if(error) {\n    showError($('#viewTriggers'), \"There is already an evenemential trigger defined (\"+error+\"). Only one is allowed per combined trigger.\");\n    return;\n  }\n\n  var last = true;\n  select.find('option').each(function() {\n      if ($(this).val() > value) {\n          $('<option value=\"' + value + '\" selected=\"selected\">' + value_pretty + '</option>').insertBefore(this);\n          last = false;\n          return false;\n      }\n  });\n  if (last)\n      select.append('<option value=\"' + value + '\" selected=\"selected\">' + value_pretty + '</option>');\n  select.trigger(\"chosen:updated\");\n\n};\n\nViolationsView.prototype.add_fingerbank_trigger = function(search, id, display){\n  var that = this;\n  violationsView.append_trigger(search.model_stripped()+\"::\"+id, search.model_stripped() + \" \" + display);\n};\n\nvar violationsView = new ViolationsView();\n"]}